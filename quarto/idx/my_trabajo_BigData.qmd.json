{"title":"Paco Te quiero","markdown":{"yaml":{"title":"Paco Te quiero","description":"(El grupo de música barcelonés)","author":["Javier Mascarell (jamasga@alumni.uv.es)"],"date":"2024-01-19","categories":["trabajo BigData"],"image":"imagenes/r_logo.png","title-block-banner":true,"title-block-banner-color":"#FBFCF5","toc-depth":3,"smooth-scroll":true,"format":{"html":{"backgroundcolor":"#FBFCF5","embed-resources":true,"link-external-newwindow":true,"css":"my_styles.css"}},"code-tools":true,"code-link":true},"headingText":"Resumen del trabajo","containsRefs":false,"markdown":"\n\n```{r}\n#| code-fold: true\n#| warning: false\n\n#install.packages(\"readxl\")\n#install.packages(\"highcharter\")\n#install.packages(\"leaflet\")\n#install.packages(\"osmdata\")\n#install.packages(\"fmsb\")\n\nlibrary(tidyverse)\nlibrary(dplyr)\nlibrary(readxl)\nlibrary(highcharter)\nlibrary(leaflet)\nlibrary(osmdata)\nlibrary(vembedr)\nlibrary(fmsb)\nlibrary(knitr)\n\n#Creo un objeto que contiene las fechas de lanzamientos de canciones y otro objeto con las fechas de los conciertos.\nfechas_lanzamiento <- as.Date(c(\"2022-07-28\", \"2022-08-25\", \"2022-10-27\", \"2023-04-06\", \"2023-05-25\", \"2023-07-06\", \"2023-10-10\", \"2023-12-07\"))\nfechas_lanzamiento <- as.numeric(as.POSIXct(fechas_lanzamiento, origin = \"1970-01-01\")) * 1000\n\nfechas_conciertos <- as.Date(c(\"2023-04-21\", \"2023-07-13\", \"2023-10-20\", \"2023-10-25\")) # Añade tus fechas de conciertos\nfechas_conciertos <- as.numeric(as.POSIXct(fechas_conciertos, origin = \"1970-01-01\")) * 1000\n\n\n```\n\n\nEste trabajo individual trata sobre el grupo de música \"Paco Te quiero\", del cual forma parte mi amigo Joan. Más adelante, se proporciona información detallada sobre este quinteto.\n\nPara la elaboración de todos los gráficos y materiales similares, he utilizado exclusivamente datos de Spotify for Artists. Obtener estos datos no fue tarea sencilla, y pude lograrlo mediante la capacidad de inspeccionar elementos (gráficos web) y limpiarlos con la función de buscar y seleccionar de Word.\n\n\n# Introducción del grupo\n\n[“Paco te quiero”](https://www.instagram.com/pacotequieroo/) es la respuesta a los días de bajona de cinco chavalas y chavales. Letras post adolescentes que giran en torno a las relaciones amorosas y destilan pesimismo, baja autoestima y en ocasiones antipatía. A través de melodías pop y sonidos que rozan el noise, tratan temas como la dependencia emocional, la salud mental o la responsabilidad afectiva. Bajona bailable al fin y al cabo. Recomendamos escuchar  [las canciones](https://open.spotify.com/intl-es/artist/5da84dECf86iCOP1dchjJc) andando de camino a tu casa cuando vuelves de fiesta y te entra la tristeza. \n\n## Integrantes del grupo\n\n```{r, echo=FALSE, out.width='100%'}\n#| code-fold: true\n#| warning: false\nknitr::include_graphics(\"imagenes/Integrantes.png\")\n```\n\nSus integrantes lo conforman cinco amigas y amigos. Gloria Ribas (voz), Lucía Matamoros (voz y guitarra), Frans Ribas (guitarra), Joan Martínez (bajo) y Pablo Robres (batería). Todos tienen algo en común y es que aman a Paco, el alter ego canallita del batería del grupo.\n\n# Datos sobre el grupo\n\n```{r}\n#| code-fold: true\n#| warning: false\n\n#Cargamos los datos que contienen las fuentes desde donde provienen cada una de las escuchas, oyentes distintos, escucha por oyente, guardados, playlists y seguidores\n\nEscuchas <-  read_excel(\"Datos/Escuchas.xlsx\")\nOyentes <-  read_excel(\"Datos/Oyentes.xlsx\")\nE_O <-  read_excel(\"Datos/E_O.xlsx\")\nGuardados <-  read_excel(\"Datos/Guardados.xlsx\")\nPlaylists <-  read_excel(\"Datos/Playlists.xlsx\")\nSeguidores <-  read_excel(\"Datos/Seguidores.xlsx\")\n\n#Transformamos el df para convertirlo en Tidy, convertimos los valores de la columna fecha a fecha y cambiamos los nombres.\n\nEscuchas <- pivot_longer(Escuchas, cols = -Fecha, names_to = \"Variable\", values_to = \"Valor\")\n\nEscuchas$Fecha <- as.Date(Escuchas$Fecha)\nEscuchas <- Escuchas[!is.na(Escuchas$Valor), ]\nEscuchas <- Escuchas %>%\n  mutate(Variable = case_when(\n    Variable == \"T_activas_E\" ~ \"Todas las fuentes activas\",\n    Variable == \"Cat_E\" ~ \"Catalogo y perfil de artista\",\n    Variable == \"Biblio_E\" ~ \"Biblioteca y listas del/de la oyente\",\n    Variable == \"Cola_E\" ~ \"Cola del/de la oyente\",\n    Variable == \"T_programadas_E\" ~ \"Todas las fuentes programadas\",\n    Variable == \"Editor_E\" ~ \"Listas editoriales\",\n    Variable == \"Mixes_E\" ~ \"Mixes y listas algorítmicas\",\n    Variable == \"Person_E\" ~ \"Listas editoriales personalizadas\",\n    Variable == \"De_otros_E\" ~ \"Listas de reproducción de otros oyentes\",\n    Variable == \"Radio_E\" ~ \"Radio y autoplay\",\n    Variable == \"Otros_E\" ~ \"Otros\",\n    Variable == \"Total_E\" ~ \"Escuchas totales por dia\"))\n\nOyentes <- pivot_longer(Oyentes, cols = -Fecha, names_to = \"Variable\", values_to = \"Valor\")\n\nOyentes$Fecha <- as.Date(Oyentes$Fecha)\nOyentes <- Oyentes[!is.na(Oyentes$Valor), ]\nOyentes <- Oyentes %>%\n  mutate(Variable = case_when(\n    Variable == \"T_activas_O\" ~ \"Todas las fuentes activas\",\n    Variable == \"Cat_O\" ~ \"Catalogo y perfil de artista\",\n    Variable == \"Biblio_O\" ~ \"Biblioteca y listas del/de la oyente\",\n    Variable == \"Cola_O\" ~ \"Cola del/de la oyente\",\n    Variable == \"T_programadas_O\" ~ \"Todas las fuentes programadas\",\n    Variable == \"Editor_O\" ~ \"Listas editoriales\",\n    Variable == \"Mixes_O\" ~ \"Mixes y listas algorítmicas\",\n    Variable == \"Person_O\" ~ \"Listas editoriales personalizadas\",\n    Variable == \"De_otros_O\" ~ \"Listas de reproducción de otros oyentes\",\n    Variable == \"Radio_O\" ~ \"Radio y autoplay\",\n    Variable == \"Otros_O\" ~ \"Otros\",\n    Variable == \"Total_O\" ~ \"Oyentes totales por dia\"))\n\nE_O <- pivot_longer(E_O, cols = -Fecha, names_to = \"Variable\", values_to = \"Valor\")\n\nE_O$Fecha <- as.Date(E_O$Fecha)\nE_O <- E_O[!is.na(E_O$Valor), ]\nE_O <- E_O %>%\n  mutate(Variable = case_when(\n    Variable == \"T_activas_E\" ~ \"Todas las fuentes activas\",\n    Variable == \"Cat_E\" ~ \"Catalogo y perfil de artista\",\n    Variable == \"Biblio_E\" ~ \"Biblioteca y listas del/de la oyente\",\n    Variable == \"Cola_E\" ~ \"Cola del/de la oyente\",\n    Variable == \"T_programadas_E\" ~ \"Todas las fuentes programadas\",\n    Variable == \"Editor_E\" ~ \"Listas editoriales\",\n    Variable == \"Mixes_E\" ~ \"Mixes y listas algorítmicas\",\n    Variable == \"Person_E\" ~ \"Listas editoriales personalizadas\",\n    Variable == \"De_otros_E\" ~ \"Listas de reproducción de otros oyentes\",\n    Variable == \"Radio_E\" ~ \"Radio y autoplay\",\n    Variable == \"Otros_E\" ~ \"Otros\"))\n\n#En estos casos solo hay un dato por fecha, por lo que no es necesario realizar grandes cambios.\n\nGuardados$Fecha <- as.Date(Guardados$Fecha)\n\nPlaylists$Fecha <- as.Date(Playlists$Fecha)\n\nSeguidores$Fecha <- as.Date(Seguidores$Fecha)\n\n```\n\nEn este apartado que recoge los principales datos diarios del grupo, podemos observar las fuentes desde donde se interactúa con el grupo, es decir, aspectos como las escuchas diarias totales, listas editoriales personalizadas y la cola del oyente. [Aquí](https://support.spotify.com/es/artists/article/source-of-streams/) se puede obtener más información sobre la clasificación que Spotify realiza al respecto. Esta información es bastante relevante, ya que permite conocer cuáles han sido o pueden ser los principales escaparates del grupo y en qué partes de Spotify se pueden llegar a nuevos oyentes o lograr que una canción se destaque.\n\n::: panel-tabset\n\n## Escuchas\n\n```{r}\n#| code-fold: true\n#| warning: false\n\n#Es prácticamente igual que en el caso anterior.Me parecía muy útil, ya que otras gráficas no permiten analizar temporalmente los datos.\n\np_ESC <- highchart(type = \"stock\") %>%\n  hc_add_series(Escuchas, \"line\", hcaes(x = Fecha, y = Valor, group = Variable)) %>%\n  hc_title(text = \"Composición de las escuchas\") %>%\n  hc_xAxis(\n    type = \"datetime\",\n    plotLines = c(\n      lapply(fechas_lanzamiento, function(x) list(\n        value = x,\n        width = 2,\n        color = \"red\"\n      )),\n      lapply(fechas_conciertos, function(x) list(\n        value = x,\n        width = 2,\n        color = \"yellow\"\n      ))\n    )\n  ) %>%  hc_yAxis(title = list(text = \"Valor\"), type = \"logarithmic\", minorTickInterval = \"auto\") %>%\n  hc_tooltip(shared = TRUE, crosshairs = TRUE) %>%\n  hc_exporting(enabled = TRUE) %>%\n  hc_rangeSelector(\n    enabled = TRUE,\n    selected = 4,\n    buttons = list(\n      list(type = 'month', count = 1, text = '1m'),\n      list(type = 'month', count = 3, text = '3m'),\n      list(type = 'month', count = 6, text = '6m'),\n      list(type = 'year', count = 1, text = '1y'),\n      list(type = 'all', text = 'Todo')\n    )\n  ) %>%\n  hc_navigator(enabled = TRUE) %>%  # Permite el desplazamiento en la barra inferior\n  hc_scrollbar(enabled = TRUE)  # Habilita la barra de desplazamiento\n\np_ESC\n\n```\n\n## Oyentes\n\n```{r}\n#| code-fold: true\n#| warning: false\n\np_OYE <- highchart(type = \"stock\") %>%\n  hc_add_series(Oyentes, \"line\", hcaes(x = Fecha, y = Valor, group = Variable)) %>%\n  hc_title(text = \"Composición de los oyentes\") %>%\n  hc_xAxis(\n    type = \"datetime\",\n    plotLines = c(\n      lapply(fechas_lanzamiento, function(x) list(\n        value = x,\n        width = 2,\n        color = \"red\"\n      )),\n      lapply(fechas_conciertos, function(x) list(\n        value = x,\n        width = 2,\n        color = \"yellow\"\n      ))\n    )\n  ) %>%  hc_yAxis(title = list(text = \"Valor\"), type = \"logarithmic\", minorTickInterval = \"auto\") %>%\n  hc_tooltip(shared = TRUE, crosshairs = TRUE) %>%\n  hc_exporting(enabled = TRUE) %>%\n  hc_rangeSelector(\n    enabled = TRUE,\n    selected = 4,\n    buttons = list(\n      list(type = 'month', count = 1, text = '1m'),\n      list(type = 'month', count = 3, text = '3m'),\n      list(type = 'month', count = 6, text = '6m'),\n      list(type = 'year', count = 1, text = '1y'),\n      list(type = 'all', text = 'Todo')\n    )\n  ) %>%\n  hc_navigator(enabled = TRUE) %>%  \n  hc_scrollbar(enabled = TRUE)  \n\np_OYE\n\n```\n\n## Escuchas/Oyentes\n\n```{r}\n#| code-fold: true\n#| warning: false\n\np_E_O_ <- highchart(type = \"stock\") %>%\n  hc_add_series(E_O, \"line\", hcaes(x = Fecha, y = Valor, group = Variable)) %>%\n  hc_title(text = \"Composición de los oyentes\") %>%\n  hc_xAxis(\n    type = \"datetime\",\n    plotLines = c(\n      lapply(fechas_lanzamiento, function(x) list(\n        value = x,\n        width = 2,\n        color = \"red\"\n      )),\n      lapply(fechas_conciertos, function(x) list(\n        value = x,\n        width = 2,\n        color = \"yellow\"\n      ))\n    )\n  ) %>%  hc_yAxis(title = list(text = \"Valor\"), type = \"logarithmic\", minorTickInterval = \"auto\") %>%\n  hc_tooltip(shared = TRUE, crosshairs = TRUE) %>%\n  hc_exporting(enabled = TRUE) %>%\n  hc_rangeSelector(\n    enabled = TRUE,\n    selected = 4,\n    buttons = list(\n      list(type = 'month', count = 1, text = '1m'),\n      list(type = 'month', count = 3, text = '3m'),\n      list(type = 'month', count = 6, text = '6m'),\n      list(type = 'year', count = 1, text = '1y'),\n      list(type = 'all', text = 'Todo')\n    )\n  ) %>%\n  hc_navigator(enabled = TRUE) %>%  \n  hc_scrollbar(enabled = TRUE)  \n\np_E_O_\n\n```\n\n## Guardados\n\n```{r}\n#| code-fold: true\n#| warning: false\n\np_GUAR <- highchart(type = \"stock\") %>%\n  hc_add_series(Guardados, \"line\", hcaes(x = Fecha, y = Valor_G), name = \"Nuevos guardados\") %>%\n  hc_title(text = \"Número de guardados por día\") %>%\n  hc_xAxis(\n    type = \"datetime\",\n    plotLines = c(\n      lapply(fechas_lanzamiento, function(x) list(\n        value = x,\n        width = 2,\n        color = \"red\"\n      )),\n      lapply(fechas_conciertos, function(x) list(\n        value = x,\n        width = 2,\n        color = \"yellow\"\n      ))\n    )\n  ) %>%  hc_yAxis(title = list(text = \"Valor\"), type = \"logarithmic\", minorTickInterval = \"auto\") %>%\n  hc_tooltip(shared = TRUE, crosshairs = TRUE) %>%\n  hc_exporting(enabled = TRUE) %>%\n  hc_rangeSelector(\n    enabled = TRUE,\n    selected = 4,\n    buttons = list(\n      list(type = 'month', count = 1, text = '1m'),\n      list(type = 'month', count = 3, text = '3m'),\n      list(type = 'month', count = 6, text = '6m'),\n      list(type = 'year', count = 1, text = '1y'),\n      list(type = 'all', text = 'Todo')\n    )\n  ) %>%\n  hc_navigator(enabled = TRUE) %>%  \n  hc_scrollbar(enabled = TRUE)  \n\np_GUAR\n\n```\n\n## Playlists\n\n```{r}\n#| code-fold: true\n#| warning: false\n\np_PLAY <- highchart(type = \"stock\") %>%\n  hc_add_series(Playlists, \"line\", hcaes(x = Fecha, y = Valor_P), name = \"Nuevas playlists\") %>%\n  hc_title(text = \"Número de guardados por día\") %>%\n  hc_xAxis(\n    type = \"datetime\",\n    plotLines = c(\n      lapply(fechas_lanzamiento, function(x) list(\n        value = x,\n        width = 2,\n        color = \"red\"\n      )),\n      lapply(fechas_conciertos, function(x) list(\n        value = x,\n        width = 2,\n        color = \"yellow\"\n      ))\n    )\n  ) %>%  hc_yAxis(title = list(text = \"Valor\"), type = \"logarithmic\", minorTickInterval = \"auto\") %>%\n  hc_tooltip(shared = TRUE, crosshairs = TRUE) %>%\n  hc_exporting(enabled = TRUE) %>%\n  hc_rangeSelector(\n    enabled = TRUE,\n    selected = 4,\n    buttons = list(\n      list(type = 'month', count = 1, text = '1m'),\n      list(type = 'month', count = 3, text = '3m'),\n      list(type = 'month', count = 6, text = '6m'),\n      list(type = 'year', count = 1, text = '1y'),\n      list(type = 'all', text = 'Todo')\n    )\n  ) %>%\n  hc_navigator(enabled = TRUE) %>%  \n  hc_scrollbar(enabled = TRUE)  \n\np_PLAY\n\n```\n\n## Seguidores\n\n```{r}\n#| code-fold: true\n#| warning: false\n\np_SEG <- highchart(type = \"stock\") %>%\n  hc_add_series(Seguidores, \"line\", hcaes(x = Fecha, y = Valor_S), name = \"Seguidores totales\") %>%\n  hc_title(text = \"Nº de seguidores totales\") %>%\n  hc_xAxis(\n    type = \"datetime\",\n    plotLines = c(\n      lapply(fechas_lanzamiento, function(x) list(\n        value = x,\n        width = 2,\n        color = \"red\"\n      )),\n      lapply(fechas_conciertos, function(x) list(\n        value = x,\n        width = 2,\n        color = \"yellow\"\n      ))\n    )\n  ) %>%  hc_yAxis(title = list(text = \"Valor\"), type = \"logarithmic\", minorTickInterval = \"auto\") %>%\n  hc_tooltip(shared = TRUE, crosshairs = TRUE) %>%\n  hc_exporting(enabled = TRUE) %>%\n  hc_rangeSelector(\n    enabled = TRUE,\n    selected = 4,\n    buttons = list(\n      list(type = 'month', count = 1, text = '1m'),\n      list(type = 'month', count = 3, text = '3m'),\n      list(type = 'month', count = 6, text = '6m'),\n      list(type = 'year', count = 1, text = '1y'),\n      list(type = 'all', text = 'Todo')\n    )\n  ) %>%\n  hc_navigator(enabled = TRUE) %>%  \n  hc_scrollbar(enabled = TRUE)  \n\np_SEG\n\n```\n\n## Procedimiento\n\nEl procedimiento ha sido muy similar al de los datos de las canciones. Se consideró utilizar otro tipo de gráfico, pero por un lado, es difícil hacerlo amigable con tantos datos y, por otro, podría romper un poco con la estética de la página.\n\nEstá explicado en el procedimiento de los datos de las canciones.\n\n:::\n\n# Algunas canciones del grupo\n\n## Demolición\n\nEs el segundo adelanto del EP: [‘Adultas depende del día’](https://open.spotify.com/intl-es/album/4f20lPAxbiIpWXrxP1cCp1). A medida que una se convierte en adulta, el concepto de noche cambia. Lo que antes era un simple divertimento, ahora se ha convertido en una vía de escape. De eso va ‘demolición’. De excesos, de falta de amor propio, de adicciones, de descontrol. Del momento exacto en el que uno se da cuenta de que todo ha cambiado.\n\n```{r, out.extra=c('allow=\"encrypted-media\"', 'allowtransparency=\"true\"', 'frameBorder=\"0\"')}\n#| code-fold: true\n#| warning: false\n\nknitr::include_url(\"https://open.spotify.com/embed/track/61FPKErHn6wh4eGYe9FGTk?utm_source=generator\", height = \"152\")\n```\n\n\n## Becariasoy@gmail.com\n\nHas acabado la carrera. 4 años. Has encontrado prácticas. Son en Madrid. Tú eres de Barcelona. Pero da igual, decides ir. Va bien. Te ascienden. Ahora eres creativo. Te habla tu ex. La de toda la vida. A la cual sigues queriendo. Quedas con ella. Te vuelve a dejar. Y al día siguiente has de ir a trabajar. Y no puedes. Y crees que es temporal. Pero no. A la semana siguiente tampoco puedes. Ni al mes. Lo has dejado todo atrás. Y simplemente no puedes. Y entonces escribo [becariasoy@gmail.com](https://open.spotify.com/intl-es/track/3XCAMyvSxB1XS2LvTnHb90). Y me mudo a Barcelona y la componemos. Guitarra Shoegaze, melodía Pop, estructura Indie; Nuestro nuevo sonido.\n\n```{r, out.extra=c('allow=\"encrypted-media\"', 'allowtransparency=\"true\"', 'frameBorder=\"0\"')}\n#| code-fold: true\n#| warning: false\n\nknitr::include_url(\"https://open.spotify.com/embed/track/3XCAMyvSxB1XS2LvTnHb90?utm_source=generator&theme=0\", height = \"152\")\n\n```\n\n## Bajona de verano\n\nTrata de abordar el tema de la dependencia emocional. La canción está escrita a través del punto de vista de un personaje, el cual siempre ha recurrido al cariño de la misma persona para animarse y recuperarse en los momentos de bajona. Esta vez, esa persona no está, por lo que por primera vez, deberá enfrentarse a sus fantasmas en solitario, y le resulta imposible.\n\n```{r}\n#| code-fold: true\n#| warning: false\n\n#| echo = FALSE,\n#| out.width = \"100%\"\nembed_url(\"https://www.youtube.com/watch?v=Hef7bAt3BWA\")\n\n```\n\n# Datos comparando canciones por días\n\n```{r}\n#| code-fold: true\n#| warning: false\n\nA <-  read_excel(\"Datos/A.xlsx\")\nL <-  read_excel(\"Datos/L.xlsx\")\nBe <-  read_excel(\"Datos/Be.xlsx\")\nP <-  read_excel(\"Datos/P.xlsx\")\nH <-  read_excel(\"Datos/H.xlsx\")\nBa <-  read_excel(\"Datos/Ba.xlsx\")\nM <-  read_excel(\"Datos/M.xlsx\")\nD <-  read_excel(\"Datos/D.xlsx\")\n\n#De esta manera agrupo los df en uno para tener la informacion junta con los datos de todas las canciones.\ndf_total <- Reduce(function(x, y) merge(x, y, by = \"Fecha\", all = TRUE), \n                    list(A, L, Be, P, H, Ba, M, D))\n\n#Creo estos objetos para poder filtrar las columnas que me interesan.\nc_escuchas <- grep(\"Escuchas\", names(df_total), value = TRUE)\nc_oyentes <- grep(\"Oyentes\", names(df_total), value = TRUE)\nc_e_o <- grep(\"E_O\", names(df_total), value = TRUE)\nc_playlists <- grep(\"N_playlists\", names(df_total), value = TRUE)\nc_guardados <- grep(\"N_Guardados\", names(df_total), value = TRUE)\n\n#Creo un df por cada dato que agrupe todas las canciones y hago pivot longer para que sea tidy y se pueda implementar en los gráficos (una columna para la serie, otra para el eje x y otra para el eje y). También aprovecho para cambiar los nombres.\n#Podría haber cambiado los nombres previamente, pero para mi era menos liante establecer los nombre una vez obtenidos los df.\ndf_escuchas <- df_total[, c(\"Fecha\", c_escuchas)]\ndf_escuchas <- pivot_longer(df_escuchas, cols = -Fecha, names_to = \"Variable\", values_to = \"Valor\")\n\ndf_escuchas$Fecha <- as.Date(df_escuchas$Fecha)\ndf_escuchas <- df_escuchas[!is.na(df_escuchas$Valor), ]\ndf_escuchas <- df_escuchas %>%\n  mutate(Variable = case_when(\n    Variable == \"Escuchas_H\" ~ \"Hoy (Lo siento)\",\n    Variable == \"Escuchas_M\" ~ \"Momento Funesto\",\n    Variable == \"Escuchas_Ba\" ~ \"Bajona de Verano\",\n    Variable == \"Escuchas_P\" ~ \"pase lo que pase\",\n    Variable == \"Escuchas_D\" ~ \"demolicion\",\n    Variable == \"Escuchas_Be\" ~ \"becariasoy@gmail.com\",\n    Variable == \"Escuchas_L\" ~ \"Lo Que Haces Siempre\",\n    Variable == \"Escuchas_A\" ~ \"Aunque Tenga Miedo\"))\n\ndf_oyentes <- df_total[, c(\"Fecha\", c_oyentes)]\ndf_oyentes <- pivot_longer(df_oyentes, cols = -Fecha, names_to = \"Variable\", values_to = \"Valor\")\n\ndf_oyentes$Fecha <- as.Date(df_oyentes$Fecha)\ndf_oyentes <- df_oyentes[!is.na(df_oyentes$Valor), ]\ndf_oyentes <- df_oyentes %>%\n  mutate(Variable = case_when(\n    Variable == \"Oyentes_H\" ~ \"Hoy (Lo siento)\",\n    Variable == \"Oyentes_M\" ~ \"Momento Funesto\",\n    Variable == \"Oyentes_Ba\" ~ \"Bajona de Verano\",\n    Variable == \"Oyentes_P\" ~ \"pase lo que pase\",\n    Variable == \"Oyentes_D\" ~ \"demolicion\",\n    Variable == \"Oyentes_Be\" ~ \"becariasoy@gmail.com\",\n    Variable == \"Oyentes_L\" ~ \"Lo Que Haces Siempre\",\n    Variable == \"Oyentes_A\" ~ \"Aunque Tenga Miedo\"))\n\ndf_e_o <- df_total[, c(\"Fecha\", c_e_o)]\ndf_e_o <- pivot_longer(df_e_o, cols = -Fecha, names_to = \"Variable\", values_to = \"Valor\")\n\ndf_e_o$Fecha <- as.Date(df_e_o$Fecha)\ndf_e_o <- df_e_o[!is.na(df_e_o$Valor), ]\ndf_e_o <- df_e_o %>%\n  mutate(Variable = case_when(\n    Variable == \"E_O_H\" ~ \"Hoy (Lo siento)\",\n    Variable == \"E_O_M\" ~ \"Momento Funesto\",\n    Variable == \"E_O_Ba\" ~ \"Bajona de Verano\",\n    Variable == \"E_O_P\" ~ \"pase lo que pase\",\n    Variable == \"E_O_D\" ~ \"demolicion\",\n    Variable == \"E_O_Be\" ~ \"becariasoy@gmail.com\",\n    Variable == \"E_O_L\" ~ \"Lo Que Haces Siempre\",\n    Variable == \"E_O_A\" ~ \"Aunque Tenga Miedo\"))\n\ndf_e_o <- df_total[, c(\"Fecha\", c_e_o)]\ndf_e_o <- pivot_longer(df_e_o, cols = -Fecha, names_to = \"Variable\", values_to = \"Valor\")\n\ndf_e_o$Fecha <- as.Date(df_e_o$Fecha)\ndf_e_o <- df_e_o[!is.na(df_e_o$Valor), ]\ndf_e_o <- df_e_o %>%\n  mutate(Variable = case_when(\n    Variable == \"E_O_H\" ~ \"Hoy (Lo siento)\",\n    Variable == \"E_O_M\" ~ \"Momento Funesto\",\n    Variable == \"E_O_Ba\" ~ \"Bajona de Verano\",\n    Variable == \"E_O_P\" ~ \"pase lo que pase\",\n    Variable == \"E_O_D\" ~ \"demolicion\",\n    Variable == \"E_O_Be\" ~ \"becariasoy@gmail.com\",\n    Variable == \"E_O_L\" ~ \"Lo Que Haces Siempre\",\n    Variable == \"E_O_A\" ~ \"Aunque Tenga Miedo\"))\n\ndf_playlists <- df_total[, c(\"Fecha\", c_playlists)]\ndf_playlists <- pivot_longer(df_playlists, cols = -Fecha, names_to = \"Variable\", values_to = \"Valor\")\n\ndf_playlists$Fecha <- as.Date(df_playlists$Fecha)\ndf_playlists <- df_playlists[!is.na(df_playlists$Valor), ]\ndf_playlists <- df_playlists %>%\n  mutate(Variable = case_when(\n    Variable == \"N_playlists_H\" ~ \"Hoy (Lo siento)\",\n    Variable == \"N_playlists_M\" ~ \"Momento Funesto\",\n    Variable == \"N_playlists_Ba\" ~ \"Bajona de Verano\",\n    Variable == \"N_playlists_P\" ~ \"pase lo que pase\",\n    Variable == \"N_playlists_D\" ~ \"demolicion\",\n    Variable == \"N_playlists_Be\" ~ \"becariasoy@gmail.com\",\n    Variable == \"N_playlists_L\" ~ \"Lo Que Haces Siempre\",\n    Variable == \"N_playlists_A\" ~ \"Aunque Tenga Miedo\"))\n\ndf_guardados <- df_total[, c(\"Fecha\", c_guardados)]\ndf_guardados <- pivot_longer(df_guardados, cols = -Fecha, names_to = \"Variable\", values_to = \"Valor\")\n\ndf_guardados$Fecha <- as.Date(df_guardados$Fecha)\ndf_guardados <- df_guardados[!is.na(df_guardados$Valor), ]\ndf_guardados <- df_guardados %>%\n  mutate(Variable = case_when(\n    Variable == \"N_Guardados_H\" ~ \"Hoy (Lo siento)\",\n    Variable == \"N_Guardados_M\" ~ \"Momento Funesto\",\n    Variable == \"N_Guardados_Ba\" ~ \"Bajona de Verano\",\n    Variable == \"N_Guardados_P\" ~ \"pase lo que pase\",\n    Variable == \"N_Guardados_D\" ~ \"demolicion\",\n    Variable == \"N_Guardados_Be\" ~ \"becariasoy@gmail.com\",\n    Variable == \"N_Guardados_L\" ~ \"Lo Que Haces Siempre\",\n    Variable == \"N_Guardados_A\" ~ \"Aunque Tenga Miedo\"))\n\n#Aunque lo anterior parezca una redundancia por cambiar los nombre cada vez, para mí es mucho más limpio y me permite organizarme mejor en caso de querer realizar cambios.\n\n```\n\nEn este apartado, se han analizado los datos diarios de las canciones del grupo y se han separado en 6 gráficos interactivos. Estos contienen el número de escuchas, oyentes, escuchas por oyente, playlists y guardados. Se han añadido barras rojas verticales que representan el lanzamiento de una nueva canción y barras amarillas que muestran la fecha de un concierto, facilitando la observación de su influencia de manera clara.\n\nEs importante destacar los gráficos del paquete Highcharter (se requiere una licencia), ya que permiten seleccionar un rango de fechas específico y desplazarse a lo largo del tiempo mediante la barra inferior. También permiten visualizar el número concreto de cada serie en un día específico al arrastrar el cursor, descargar una imagen y acceder a los datos, entre otras funcionalidades.\n\n::: panel-tabset\n\n## Escuchas\n\n```{r}\n#| code-fold: true\n#| warning: false\n\n#Para elaborar los gráficos he utilizado el paquete highcharter de la empresa Highchart (es muy utilizado en páginas web con gréficos de activos)\n\n#Este software no es libre para el uso comercial, pero si que permiten su uso bajo en el ámbito académico (Adjunto la licencia en la carpeta)\n\n#He realizado un gráfico por tipo de dato con todas las canciones.\n\np_escuchas <- highchart(type = \"stock\") %>%\n  hc_add_series(df_escuchas, \"line\", hcaes(x = Fecha, y = Valor, group = Variable)) %>% \n\n#de esta manera puedo añadir una serie junto a los ejes agrupando el color por canciones\n  \n  hc_title(text = \"Numero de escuchas por canción\") %>%\n  hc_xAxis(\n    type = \"datetime\", \n\n#He utilizado esta función para añadir una linea vertical de color rojo en el caso de lanzamientos de canciones y amarillo en el caso de conciertos.\n\n    plotLines = c(\n      lapply(fechas_lanzamiento, function(x) list(\n        value = x,\n        width = 2,\n        color = \"red\"\n      )),\n      lapply(fechas_conciertos, function(x) list(\n        value = x,\n        width = 2,\n        color = \"yellow\"\n      ))\n    )\n  ) %>%  hc_yAxis(title = list(text = \"Valor\"), type = \"logarithmic\", minorTickInterval = \"auto\") %>%\n  hc_tooltip(shared = TRUE, crosshairs = TRUE) %>%\n  hc_exporting(enabled = TRUE) %>%\n  hc_rangeSelector(\n    enabled = TRUE,\n    selected = 4,\n    buttons = list(\n      list(type = 'month', count = 1, text = '1m'),\n      list(type = 'month', count = 3, text = '3m'),\n      list(type = 'month', count = 6, text = '6m'),\n      list(type = 'year', count = 1, text = '1y'),\n      list(type = 'all', text = 'Todo')\n    ) \n\n#Gracias a esta herramienta se puede seleccionar la temporalidad manualmente.\n\n  ) %>%\n  hc_navigator(enabled = TRUE) %>%  \n\n# Permite un desplazamiento en la barra inferior\n  \n  hc_scrollbar(enabled = TRUE)  \n\n# Habilita la barra de desplazamiento\n\np_escuchas\n\n```\n\n## Oyentes\n\n```{r}\n#| code-fold: true\n#| warning: false\n\np_oyentes <- highchart(type = \"stock\") %>%\n  hc_add_series(df_oyentes, \"line\", hcaes(x = Fecha, y = Valor, group = Variable)) %>%\n  hc_title(text = \"Numero de Oyentes por canción\") %>%\n  hc_xAxis(\n    type = \"datetime\",\n    plotLines = c(\n      lapply(fechas_lanzamiento, function(x) list(\n        value = x,\n        width = 2,\n        color = \"red\"\n      )),\n      lapply(fechas_conciertos, function(x) list(\n        value = x,\n        width = 2,\n        color = \"yellow\"\n      ))\n    )\n  ) %>%  hc_yAxis(title = list(text = \"Valor\"), type = \"logarithmic\", minorTickInterval = \"auto\") %>%\n  hc_tooltip(shared = TRUE, crosshairs = TRUE) %>%\n  hc_exporting(enabled = TRUE) %>%\n  hc_rangeSelector(\n    enabled = TRUE,\n    selected = 4,\n    buttons = list(\n      list(type = 'month', count = 1, text = '1m'),\n      list(type = 'month', count = 3, text = '3m'),\n      list(type = 'month', count = 6, text = '6m'),\n      list(type = 'year', count = 1, text = '1y'),\n      list(type = 'all', text = 'Todo')\n    )\n  ) %>%\n  hc_navigator(enabled = TRUE) %>%  \n  hc_scrollbar(enabled = TRUE)  \n\np_oyentes\n\n```\n\n## Escuchas/Oyentes\n\n```{r}\n#| code-fold: true\n#| warning: false\n\np_e_o <- highchart(type = \"stock\") %>%\n  hc_add_series(df_e_o, \"line\", hcaes(x = Fecha, y = Valor, group = Variable)) %>%\n  hc_title(text = \"Numero de Escuchas/Oyentes por canción\") %>%\n  hc_xAxis(\n    type = \"datetime\",\n    plotLines = c(\n      lapply(fechas_lanzamiento, function(x) list(\n        value = x,\n        width = 2,\n        color = \"red\"\n      )),\n      lapply(fechas_conciertos, function(x) list(\n        value = x,\n        width = 2,\n        color = \"yellow\"\n      ))\n    )\n  ) %>%  hc_yAxis(title = list(text = \"Valor\"), type = \"logarithmic\", minorTickInterval = \"auto\") %>%\n  hc_tooltip(shared = TRUE, crosshairs = TRUE) %>%\n  hc_exporting(enabled = TRUE) %>%\n  hc_rangeSelector(\n    enabled = TRUE,\n    selected = 4,\n    buttons = list(\n      list(type = 'month', count = 1, text = '1m'),\n      list(type = 'month', count = 3, text = '3m'),\n      list(type = 'month', count = 6, text = '6m'),\n      list(type = 'year', count = 1, text = '1y'),\n      list(type = 'all', text = 'Todo')\n    )\n  ) %>%\n  hc_navigator(enabled = TRUE) %>%  \n  hc_scrollbar(enabled = TRUE)  \n\np_e_o\n\n```\n\n## Playlists\n\n```{r}\n#| code-fold: true\n#| warning: false\n\np_playlists <- highchart(type = \"stock\") %>%\n  hc_add_series(df_playlists, \"line\", hcaes(x = Fecha, y = Valor, group = Variable)) %>%\n  hc_title(text = \"Numero de Playlists nuevas por canción\") %>%\n  hc_xAxis(\n    type = \"datetime\",\n    plotLines = c(\n      lapply(fechas_lanzamiento, function(x) list(\n        value = x,\n        width = 2,\n        color = \"red\"\n      )),\n      lapply(fechas_conciertos, function(x) list(\n        value = x,\n        width = 2,\n        color = \"yellow\"\n      ))\n    )\n  ) %>%  hc_yAxis(title = list(text = \"Valor\"), type = \"logarithmic\", minorTickInterval = \"auto\") %>%\n  hc_tooltip(shared = TRUE, crosshairs = TRUE) %>%\n  hc_exporting(enabled = TRUE) %>%\n  hc_rangeSelector(\n    enabled = TRUE,\n    selected = 4,\n    buttons = list(\n      list(type = 'month', count = 1, text = '1m'),\n      list(type = 'month', count = 3, text = '3m'),\n      list(type = 'month', count = 6, text = '6m'),\n      list(type = 'year', count = 1, text = '1y'),\n      list(type = 'all', text = 'Todo')\n    )\n  ) %>%\n  hc_navigator(enabled = TRUE) %>%  \n  hc_scrollbar(enabled = TRUE)  \n\np_playlists\n\n```\n\n## Guardados\n\n```{r}\n#| code-fold: true\n#| warning: false\n\np_guardados <- highchart(type = \"stock\") %>%\n  hc_add_series(df_guardados, \"line\", hcaes(x = Fecha, y = Valor, group = Variable)) %>%\n  hc_title(text = \"Numero de nuevos Guardados por canción\") %>%\n  hc_xAxis(\n    type = \"datetime\",\n    plotLines = c(\n      lapply(fechas_lanzamiento, function(x) list(\n        value = x,\n        width = 2,\n        color = \"red\"\n      )),\n      lapply(fechas_conciertos, function(x) list(\n        value = x,\n        width = 2,\n        color = \"yellow\"\n      ))\n    )\n  ) %>%  hc_yAxis(title = list(text = \"Valor\"), type = \"logarithmic\", minorTickInterval = \"auto\") %>%\n  hc_tooltip(shared = TRUE, crosshairs = TRUE) %>%\n  hc_exporting(enabled = TRUE) %>%\n  hc_rangeSelector(\n    enabled = TRUE,\n    selected = 4,\n    buttons = list(\n      list(type = 'month', count = 1, text = '1m'),\n      list(type = 'month', count = 3, text = '3m'),\n      list(type = 'month', count = 6, text = '6m'),\n      list(type = 'year', count = 1, text = '1y'),\n      list(type = 'all', text = 'Todo')\n    )\n  ) %>%\n  hc_navigator(enabled = TRUE) %>%  \n  hc_scrollbar(enabled = TRUE)  \n\np_guardados\n\n```\n\n## Procedimiento\n\nPara elaborar este gráfico, en primer lugar, se obtuvieron los datos, una tarea que ocupó la mayor parte del tiempo. En Spotify for Artists solo se pueden descargar los datos de las escuchas, y como no se quería hacer uso de la API key, fue necesario utilizar \"inspeccionar elemento\" en el gráfico de cada canción (un gráfico por cada tipo de número). Una vez encontrada la parte del código que contenía los datos, se copiaron y pegaron en Word para utilizar la herramienta de buscar y seleccionar, dejando únicamente los datos con sus fechas. Posteriormente, se pegaron los datos ya ordenados en una hoja de Excel.\n\nPara desarrollarlos, se separaron los dataframes según el gráfico que se deseaba obtener. Se convirtieron las columnas con los nombres de las canciones (series) en una sola columna, los datos (eje y) en otra mediante pivot longer y se utilizó la columna de fecha como eje x. En cuanto al Highchart, se destaca que está en escala logarítmica para reducir las diferencias visuales y apreciar mejor los cambios y pequeños detalles. También se añadieron todas las herramientas externas, como la elección de la temporalidad.\n\n:::\n\n# Comparación entre canciones (No temporal)\n\n```{r}\n#| code-fold: true\n#| warning: false\n\n#Aquí encontramos estadísticas básicas como máximo, mediana y desviación típica, según escuchas, oyentes, playlists y guardados. \n\nCompar_E <-  read_excel(\"Datos/Compar_E.xlsx\")\nCompar_O <-  read_excel(\"Datos/Compar_O.xlsx\")\nCompar_P <-  read_excel(\"Datos/Compar_P.xlsx\")\nCompar_G <-  read_excel(\"Datos/Compar_G.xlsx\")\n\n#En este caso lo he convertido a tidy y he convertifo los valores de la desviación típica a porcentaje.\n\nCompar_E <- pivot_longer(Compar_E, cols = -Cancion, names_to = \"Variable\", values_to = \"Valor\") %>%\n  mutate(Valor = ifelse(Variable == \"Desviacion_tipica\", Valor * 100, Valor)) %>%\n  mutate(Valor = as.numeric(Valor))  # Convertir a numérico \n\nCompar_O <- pivot_longer(Compar_O, cols = -Cancion, names_to = \"Variable\", values_to = \"Valor\") %>%\n  mutate(Valor = ifelse(Variable == \"Desviacion_tipica\", Valor * 100, Valor)) %>%\n  mutate(Valor = as.numeric(Valor))  \n\nCompar_P <- pivot_longer(Compar_P, cols = -Cancion, names_to = \"Variable\", values_to = \"Valor\") %>%\n  mutate(Valor = ifelse(Variable == \"Desviacion_tipica\", Valor * 100, Valor)) %>%\n  mutate(Valor = as.numeric(Valor))  \n\nCompar_G <- pivot_longer(Compar_G, cols = -Cancion, names_to = \"Variable\", values_to = \"Valor\") %>%\n  mutate(Valor = ifelse(Variable == \"Desviacion_tipica\", Valor * 100, Valor)) %>%\n  mutate(Valor = as.numeric(Valor))  \n\n#Convierto los valores a absolutos para evitar decimales muy largos de la desviación típica\n\nCompar_E <- transform(Compar_E, Valor = abs(Valor))\n\nCompar_E$Valor <- as.integer(Compar_E$Valor)\n\n#He convertido los df a gráficos de barra, dónde las barras se agrupan por canciones y se subdividen por colores según la métrica.\n\np_COMP_E <- hchart(Compar_E, \"column\", hcaes(x = Cancion, y = Valor, group = Variable)) %>%\n  hc_plotOptions(column = list(\n    dataLabels = list(\n      enabled = TRUE,\n      formatter = JS(\"function() {\n                     if (this.series.name === 'Desviacion_tipica') {\n                        return Highcharts.numberFormat(this.y, 1) + '%';\n                     } else {\n                        return Highcharts.numberFormat(this.y, 1);\n                     }\n                  }\")\n    ),\n    grouping = TRUE,\n    shadow = FALSE\n  )) %>%\n  hc_title(text = \"Comparación de Escuchas entre canciones\") %>%\n  hc_xAxis(title = list(text = \"Canción\")) %>%\n  hc_yAxis(title = list(text = \"Valor\"), type = \"logarithmic\", minorTickInterval = \"auto\") %>%\n  hc_legend(enabled = FALSE)  # Ocultar la leyenda\n\nCompar_O <- transform(Compar_O, Valor = abs(Valor))\n\nCompar_O$Valor <- as.integer(Compar_O$Valor)\n\np_COMP_O <- hchart(Compar_O, \"column\", hcaes(x = Cancion, y = Valor, group = Variable)) %>%\n  hc_plotOptions(column = list(\n    dataLabels = list(\n      enabled = TRUE,\n      formatter = JS(\"function() {\n                     if (this.series.name === 'Desviacion_tipica') {\n                        return Highcharts.numberFormat(this.y, 1) + '%';\n                     } else {\n                        return Highcharts.numberFormat(this.y, 1);\n                     }\n                  }\")\n    ),\n    grouping = TRUE,\n    shadow = FALSE\n  )) %>%\n  hc_title(text = \"Comparación de Oyentes entre canciones\") %>%\n  hc_xAxis(title = list(text = \"Canción\")) %>%\n  hc_yAxis(title = list(text = \"Valor\"), type = \"logarithmic\", minorTickInterval = \"auto\") %>%\n  hc_legend(enabled = FALSE)  # Ocultar la leyenda\n\nCompar_P <- transform(Compar_P, Valor = abs(Valor))\n\nCompar_P$Valor <- as.integer(Compar_P$Valor)\n\np_COMP_P <- hchart(Compar_P, \"column\", hcaes(x = Cancion, y = Valor, group = Variable)) %>%\n  hc_plotOptions(column = list(\n    dataLabels = list(\n      enabled = TRUE,\n      formatter = JS(\"function() {\n                     if (this.series.name === 'Desviacion_tipica') {\n                        return Highcharts.numberFormat(this.y, 1) + '%';\n                     } else {\n                        return Highcharts.numberFormat(this.y, 1);\n                     }\n                  }\")\n    ),\n    grouping = TRUE,\n    shadow = FALSE\n  )) %>%\n  hc_title(text = \"Comparación de Playlists entre canciones\") %>%\n  hc_xAxis(title = list(text = \"Canción\")) %>%\n  hc_yAxis(title = list(text = \"Valor\"), type = \"logarithmic\", minorTickInterval = \"auto\") %>%\n  hc_legend(enabled = FALSE)  # Ocultar la leyenda\n\np_COMP_G <- hchart(Compar_G, \"column\", hcaes(x = Cancion, y = Valor, group = Variable)) %>%\n  hc_plotOptions(column = list(\n    dataLabels = list(\n      enabled = TRUE,\n      formatter = JS(\"function() {\n                     if (this.series.name === 'Desviacion_tipica') {\n                        return Highcharts.numberFormat(this.y, 1) + '%';\n                     } else {\n                        return Highcharts.numberFormat(this.y, 1);\n                     }\n                  }\")\n    ),\n    grouping = TRUE,\n    shadow = FALSE\n  )) %>%\n  hc_title(text = \"Comparación de Guardados entre canciones\") %>%\n  hc_xAxis(title = list(text = \"Canción\")) %>%\n  hc_yAxis(title = list(text = \"Valor\"), type = \"logarithmic\", minorTickInterval = \"auto\") %>%\n  hc_legend(enabled = FALSE)  # Ocultar la leyenda\n\n```\n\nEn estos gráficos, podemos observar diferencias estadísticas entre las canciones para tener una visión más general. Estos datos incluyen el máximo histórico, la desviación típica sobre su media para determinar cuáles son las canciones con más estabilidad y cuáles son más fluctuantes, y por último, la mediana, que es más representativa que la media (aunque tiene cierta distorsión, ya que las canciones más nuevas tienden a tener una mayor).\n\nPara esta comparación, he utilizado un gráfico de barras, ya que considero que es la mejor herramienta para comparar pocos datos que no tienen una serie temporal.\n\n::: panel-tabset\n\n## Escuchas\n\n```{r}\n#| code-fold: true\n#| warning: false  \n#| column: screen-inset-shaded\n#| layout-nrow: 2\n\npar(mfrow = c(2, 2))\n\np_COMP_E\n\np_COMP_O\n\np_COMP_P\n\np_COMP_G\n\n```\n\n\n## Procedimiento\n\nEn primer lugar, he tenido que realizar un pivot longer para tener un dataframe tidy. También he convertido a porcentaje los valores de la desviación típica. Una vez obtenidos los dataframes, he creado los gráficos con Highcharter. En ellos, he añadido el símbolo % a los valores de desviación típica y he convertido los gráficos a una escala logarítmica, ya que había una gran diferencia entre los valores máximos y la mediana.\n\n:::\n\n# Mapa geográfico de los oyentes\n\n```{r}\n#| code-fold: true\n#| warning: false\n\n#Este ha sido un trabajo arduo, pues con la herramienta osmdata he conseguido las coordenadas da cada una de las 48 ciudades con más oyentes del mundo en los últimos 28 días. Creando un punto medio y añadiendo a un df las longitudes y latitudes obtenidas he podido lograr el df requerido para hacer el leaflet.\n\n# coords_barcelona <- osmdata::getbb(\"Barcelona, Spain\", format_out = \"matrix\")\n# coords_madrid <- osmdata::getbb(\"Madrid, Spain\", format_out = \"matrix\")\n# coords_valencia <- osmdata::getbb(\"Valencia, Spain\", format_out = \"matrix\")\n# coords_zaragoza <- osmdata::getbb(\"Zaragoza, Spain\", format_out = \"matrix\")\n# coords_malaga <- osmdata::getbb(\"Málaga, Spain\", format_out = \"matrix\")\n# coords_bilbao <- osmdata::getbb(\"Bilbao, Spain\", format_out = \"matrix\")\n# coords_sevilla <- osmdata::getbb(\"Sevilla, Spain\", format_out = \"matrix\")\n# coords_valladolid <- osmdata::getbb(\"Valladolid, Spain\", format_out = \"matrix\")\n# coords_murcia <- osmdata::getbb(\"Murcia, Spain\", format_out = \"matrix\")\n# coords_alicante <- osmdata::getbb(\"Alicante, Spain\", format_out = \"matrix\")\n# coords_vigo <- osmdata::getbb(\"Vigo, Spain\", format_out = \"matrix\")\n# coords_la_corunya <- osmdata::getbb(\"La Coruña, Spain\", format_out = \"matrix\")\n# coords_buenos_aires <- osmdata::getbb(\"Buenos Aires, Argentina\", format_out = \"matrix\")\n# coords_bogota <- osmdata::getbb(\"Bogotá, Colombia\", format_out = \"matrix\")\n# coords_santiago_de_chile <- osmdata::getbb(\"Santiago de Chile, Chile\", format_out = \"matrix\")\n# coords_vitoria <- osmdata::getbb(\"Vitoria, Spain\", format_out = \"matrix\")\n# coords_alcala <- osmdata::getbb(\"Alcalá de Henares, Spain\", format_out = \"matrix\")\n# coords_granada <- osmdata::getbb(\"Granada, Spain\", format_out = \"matrix\")\n# coords_santiago_de_compostela <- osmdata::getbb(\"Santiago de Compostela, Spain\", format_out = \"matrix\")\n# coords_sanse <- osmdata::getbb(\"San Sebastián, Spain\", format_out = \"matrix\")\n# coords_pamplona <- osmdata::getbb(\"Pamplona, Spain\", format_out = \"matrix\")\n# coords_sant_cugat <- osmdata::getbb(\"Sant Cugat, Spain\", format_out = \"matrix\")\n# coords_albacete <- osmdata::getbb(\"Albacete, Spain\", format_out = \"matrix\")\n# coords_lima <- osmdata::getbb(\"Lima, Peru\", format_out = \"matrix\")\n# coords_elche <- osmdata::getbb(\"Elche, Spain\", format_out = \"matrix\")\n# coords_salamanca <- osmdata::getbb(\"Salamanca, Spain\", format_out = \"matrix\")\n# coords_gijon <- osmdata::getbb(\"Gijón, Spain\", format_out = \"matrix\")\n# coords_sabadell <- osmdata::getbb(\"Sabadell, Spain\", format_out = \"matrix\")\n# coords_leon <- osmdata::getbb(\"León, Spain\", format_out = \"matrix\")\n# coords_palencia <- osmdata::getbb(\"Palencia, Spain\", format_out = \"matrix\")\n# coords_gandia <- osmdata::getbb(\"Gandía, Spain\", format_out = \"matrix\")\n# coords_terrassa <- osmdata::getbb(\"Terrassa, Spain\", format_out = \"matrix\")\n# coords_tarragona <- osmdata::getbb(\"Tarragona, Spain\", format_out = \"matrix\")\n# coords_cordoba <- osmdata::getbb(\"Córdoba, Spain\", format_out = \"matrix\")\n# coords_guadalajara <- osmdata::getbb(\"Guadalajara, Spain\", format_out = \"matrix\")\n# coords_palmas <- osmdata::getbb(\"Las Palmas de Gran Canaria, Spain\", format_out = \"matrix\")\n# coords_santander <- osmdata::getbb(\"Santander, Spain\", format_out = \"matrix\")\n# coords_getafe <- osmdata::getbb(\"Getafe, Spain\", format_out = \"matrix\")\n# coords_munich <- osmdata::getbb(\"Munich, Germany\", format_out = \"matrix\")\n# coords_delegacion <- osmdata::getbb(\"Gustavo A. Madero, Mexico\", format_out = \"matrix\")\n# coords_majadahonda <- osmdata::getbb(\"Majadahonda, Spain\", format_out = \"matrix\")\n# coords_sanfeliu <- osmdata::getbb(\"San Feliú de Llobregat, Spain\", format_out = \"matrix\")\n# coords_burgos <- osmdata::getbb(\"Burgos, Spain\", format_out = \"matrix\")\n# coords_oviedo <- osmdata::getbb(\"Oviedo, Spain\", format_out = \"matrix\")\n# coords_lleida <- osmdata::getbb(\"Lleida, Spain\", format_out = \"matrix\")\n# coords_badalona <- osmdata::getbb(\"Badalona, Spain\", format_out = \"matrix\")\n# coords_santboi <- osmdata::getbb(\"Sant Boi de Llobregat, Spain\", format_out = \"matrix\")\n# coords_laguna <- osmdata::getbb(\"Laguna de Duero, Spain\", format_out = \"matrix\")\n# coords_torrejon <- osmdata::getbb(\"Torrejón de Ardoz\", format_out = \"matrix\")\n\n\n# midpoint <- function(bb) {\n#   c(lon = mean(c(bb[1], bb[3])), lat = mean(c(bb[2], bb[4])))\n# }\n\n\n# barcelona_center <- midpoint(coords_barcelona)\n# madrid_center <- midpoint(coords_madrid)\n# valencia_center <- midpoint(coords_valencia)\n# zaragoza_center <- midpoint(coords_zaragoza)\n# malaga_center <- midpoint(coords_malaga)\n# bilbao_center <- midpoint(coords_bilbao)\n# sevilla_center <- midpoint(coords_sevilla)\n# valladolid_center <- midpoint(coords_valladolid)\n# murcia_center <- midpoint(coords_murcia)\n# alicante_center <- midpoint(coords_alicante)\n# vigo_center <- midpoint(coords_vigo)\n# la_corunya_center <- midpoint(coords_la_corunya)\n# buenos_aires_center <- midpoint(coords_buenos_aires)\n# bogota_center <- midpoint(coords_bogota)\n# santiago_de_chile_center <- midpoint(coords_santiago_de_chile)\n# vitoria_center <- midpoint(coords_vitoria)\n# alcala_center <- midpoint(coords_alcala)\n# granada_center <- midpoint(coords_granada)\n# santiago_de_compostela_center <- midpoint(coords_santiago_de_compostela)\n# sanse_center <- midpoint(coords_sanse)\n# pamplona_center <- midpoint(coords_pamplona)\n# sant_cugat_center <- midpoint(coords_sant_cugat)\n# albacete_center <- midpoint(coords_albacete)\n# lima_center <- midpoint(coords_lima)\n# elche_center <- midpoint(coords_elche)\n# salamanca_center <- midpoint(coords_salamanca)\n# gijon_center <- midpoint(coords_gijon)\n# sabadell_center <- midpoint(coords_sabadell)\n# leon_center <- midpoint(coords_leon)\n# palencia_center <- midpoint(coords_palencia)\n# gandia_center <- midpoint(coords_gandia)\n# terrassa_center <- midpoint(coords_terrassa)\n# tarragona_center <- midpoint(coords_tarragona)\n# cordoba_center <- midpoint(coords_cordoba)\n# guadalajara_center <- midpoint(coords_guadalajara)\n# palmas_center <- midpoint(coords_palmas)\n# santander_center <- midpoint(coords_santander)\n# getafe_center <- midpoint(coords_getafe)\n# munich_center <- midpoint(coords_munich)\n# delegacion_center <- midpoint(coords_delegacion)\n# majadahonda_center <- midpoint(coords_majadahonda)\n# sanfeliu_center <- midpoint(coords_sanfeliu)\n# burgos_center <- midpoint(coords_burgos)\n# oviedo_center <- midpoint(coords_oviedo)\n# lleida_center <- midpoint(coords_lleida)\n# badalona_center <- midpoint(coords_badalona)\n# santboi_center <- midpoint(coords_santboi)\n# laguna_center <- midpoint(coords_laguna)\n# torrejon_center <- midpoint(coords_torrejon)\n# \n# \n# \n# ciudades_coords <- data.frame(\n#   Ciudad = c(\"Barcelona\", \"Madrid\", \"Valencia\", \"Zaragoza\", \"Málaga\", \"Bilbao\", \"Sevilla\", \"Valladolid\", \"Murcia\", \"Alicante\", \"Vigo\", \"La Coruña\", \"Buenos Aires\", \"Bogotá\", \"Santiago de Chile\", \"Vitoria\", \"Alcalá de Henares\", \"Granada\", \"Santiago de Compostela\", \"San Sebastián\", \"Pamplona\", \"Sant Cugat\", \"Albacete\", \"Lima\", \"Elche\", \"Salamanca\", \"Gijón\", \"Sabadell\", \"León\", \"Palencia\", \"Gandía\", \"Terrassa\", \"Tarragona\", \"Córdoba\", \"Guadalajara\", \"Las Palmas de Gran Canaria\", \"Santander\", \"Getafe\", \"Múnich\", \"Delegación Gustavo A. Madero\", \"Majadahonda\", \"San Feliú de Llobregat\", \"Burgos\", \"Oviedo\", \"Lleida\", \"Badalona\", \"Sant Boi de Llobregat\", \"Laguna de Duero\", \"Torrejón de Ardoz\"),\n\n   \n#   Lon = c(barcelona_center[1], madrid_center[1], valencia_center[1],\n# zaragoza_center[1], malaga_center[1], bilbao_center[1], sevilla_center[1], valladolid_center[1], murcia_center[1], alicante_center[1], vigo_center[1], la_corunya_center[1], buenos_aires_center[1], bogota_center[1], santiago_de_chile_center[1], vitoria_center[1], alcala_center[1], granada_center[1], santiago_de_compostela_center[1], sanse_center[1], pamplona_center[1], sant_cugat_center[1], albacete_center[1], lima_center[1], elche_center[1], salamanca_center[1],\n# gijon_center[1], sabadell_center[1], leon_center[1], palencia_center[1],\n# gandia_center[1], terrassa_center[1], tarragona_center[1], cordoba_center[1], guadalajara_center[1], palmas_center[1], santander_center[1], getafe_center[1], munich_center[1], delegacion_center[1], majadahonda_center[1], sanfeliu_center[1], burgos_center[1], oviedo_center[1], lleida_center[1], badalona_center[1], santboi_center[1], laguna_center[1], torrejon_center[1]),\n\n\n# Lat = c(barcelona_center[2], madrid_center[2], valencia_center[2],\n# zaragoza_center[2], malaga_center[2], bilbao_center[2], sevilla_center[2], valladolid_center[2], murcia_center[2], alicante_center[2], vigo_center[2], la_corunya_center[2], buenos_aires_center[2], bogota_center[2], santiago_de_chile_center[2], vitoria_center[2], alcala_center[2], granada_center[2], santiago_de_compostela_center[2], sanse_center[2], pamplona_center[2], sant_cugat_center[2], albacete_center[2], lima_center[2], elche_center[2], salamanca_center[2],\n# gijon_center[2], sabadell_center[2], leon_center[2], palencia_center[2],\n# gandia_center[2], terrassa_center[2], tarragona_center[2], cordoba_center[2], guadalajara_center[2], palmas_center[2], santander_center[2], getafe_center[2], munich_center[2], delegacion_center[2], majadahonda_center[2], sanfeliu_center[2], burgos_center[2], oviedo_center[2], lleida_center[2], badalona_center[2], santboi_center[2], laguna_center[2], torrejon_center[2]))\n\n\n# #library(openxlsx)\n# ruta_archivo <- \"Datos/ciudades_coords.xlsx\"\n# write.xlsx(ciudades_coords, file = ruta_archivo)\n\n## Para evitar que la página deba cargar todo lo anterior he generado un excel sobre el df con las coordenadas\n\nDemografia <-  read_excel(\"Datos/Demografia.xlsx\")\nciudades_coords <- read_excel(\"Datos/ciudades_coords.xlsx\")\n\ndf_coord <- left_join(Demografia, ciudades_coords, by = \"Ciudad\")\n\n```\n\nEn este mapamundi, podemos observar las ciudades/municipios con el mayor número de oyentes del grupo durante el mes de diciembre. En color rojo están las ciudades que han tenido más de 100 oyentes, en color azul las que han tenido entre 10 y 100 oyentes, y en color verde las ciudades que han tenido menos de 10 oyentes. Las ciudades con más oyentes en diciembre fueron Barcelona con 345 oyentes y Madrid con 311.\n\n::: panel-tabset\n\n## Mapa con numero de oyentes en Diciembre\n\n```{r}\n#| code-fold: true\n#| warning: false\n\nmap <- leaflet(df_coord) %>% \n  addTiles() %>%  # Añadir las tiles básicas del mapa\n  \n# Para añadir marcadores circulares según el grupo\n  \n  addCircleMarkers(\n    ~Lon, ~Lat,  # Coordenadas\n    color = ~case_when(\n      Grupo == \"Ultra fans\" ~ \"red\", #Más de 100 oyentes\n      Grupo == \"Muy fans\" ~ \"blue\", #10 oyentes o más hasta 100\n      Grupo == \"Fans\" ~ \"green\", #Menos de 10 oyentes\n      TRUE ~ \"gray\"  # Por defecto para otros grupos\n    ),\n    popup = ~paste(Ciudad, Oyentes),  # Texto emergente\n    radius = 8  # Tamaño del marcador\n  )\n\nmap\n\n```\n\n## Procedimiento\n\nPara realizar este Leaflet, en primer lugar, he tenido que obtener las latitudes y longitudes de cada ciudad mediante el paquete osmdata. Sin embargo, también he tenido que encontrar los puntos medios de esas medidas y añadirlos al dataframe con los datos. Una vez obtenido el dataframe necesario, he generado el Leaflet añadiendo círculos de colores según el grupo al que pertenecía cada ciudad, con el tamaño deseado y una etiqueta con el número de oyentes en cada ciudad.\n\n:::\n\n# Demografría\n\n```{r}\n#| code-fold: true\n#| warning: false\n\n# Aprovechando que son pocos datos y no los tengo, he creado el df a mano para prácticar\n\nEdad_b <- data.frame(\n  row.names = c(\"a18_22\", \"a23_27\", \"a28_34\", \"a35_44\", \"a45_59\", \"aMas_60\"),\n  Mujer = c(78, 172, 153, 89, 84, 18),\n  Hombre = c(53, 136, 172, 142, 168, 21),\n  Sin_especificar = c(2, 1, 7, 5, 4, 2),\n  No_binario = c(8, 16, 8, 9, 2, 0))\n\n# Marcarmos los valores maximos y minimos para poder elaborar el gráfico de araña\n\nmax_min <- data.frame(\n  Mujer = c(172, 0), Hombre = c(172, 0), Sin_especificar = c(7, 0), No_binario = c(16, 0)\n)\n\n# Para añadir las filas al df final\n\nrownames(max_min) <- c(\"Max\", \"Min\")\nedad_bien <- rbind(max_min, Edad_b)\n\n# Seleccionamos únicamente los datos de 18 a 22 años y así sucesivamente.\n\na18_22_data <- edad_bien[c(\"Max\", \"Min\", \"a18_22\"), ]\n\na23_27_data <- edad_bien[c(\"Max\", \"Min\", \"a23_27\"), ]\n\na28_34_data <- edad_bien[c(\"Max\", \"Min\", \"a28_34\"), ]\n\na35_44_data <- edad_bien[c(\"Max\", \"Min\", \"a35_44\"), ]\n\na45_59_data <- edad_bien[c(\"Max\", \"Min\", \"a45_59\"), ]\n\naMas_60_data <- edad_bien[c(\"Max\", \"Min\", \"aMas_60\"), ]\n\n\n```\n\nSe han tomado los datos del número de oyentes en el mes de diciembre según su género y la franja de edad a la que pertenecen.\n\nMediante estos gráficos radiales con forma de tela de araña podemos observar cuanto se acerca o aleja dicho género en esa franja de edad frente al máximo registrado de ese genero en cualquier grupo de edad.\n\nPongo varios ejemplos para que se entienda. En el grupo de 18 a 22 años de edad observamos que los puntos negros no se alejan mucho del centro, esto se debe a que es un grupo poco numeroso relativamente al resto de grupos de edad, por ejemplo, en este grupo se han observado 53 hombres (muy lejos del máximo de 172 hombres registrados de los 28 a 34 años). Otro ejemplo podría ser en el grupo de 23 a 27 años, donde encontramos los máximos registrados de mujeres (172) y de no binario (16), por lo tanto viendo el gráfico tambien podemos intuir que este grupo de edad es de los más numerosos, ya que sus 4 valores se alejan bastante del centro.\n\n::: panel-tabset\n\n## 18 a 22\n\n```{r}\n#| code-fold: true\n#| warning: false \np18_22 <- radarchart(\n  a18_22_data,\n  title = \"De 18 a 22 años\",\n  cglcol = \"orange\", #Color de los bordes del gráfico\n  cglty = 2, #Permite obtener patrones separados\n  cglwd = 2, #Permite ajustar la separacion\n  plwd = 2, #Permite añadir el grosor\n  pfcol = \"#EED9AD80\"  # Color del fondo interno del polígono\n)\nradarchart(p18_22)\n```\n\n## 23 a 27\n\n```{r}\n#| code-fold: true\n#| warning: false\n\np23_27 <- radarchart(\n  a23_27_data,\n  title = \"De 23 a 27 años\",\n  cglcol = \"green\",\n  cglty = 2,\n  cglwd = 2,\n  plwd = 2,\n  pfcol = \"#D7EEAD80\"  \n)\nradarchart(p23_27)\n\n```\n\n## 28 a 34\n\n```{r}\n#| code-fold: true\n#| warning: false\n\np28_34 <- radarchart(\n  a28_34_data,\n  title = \"De 28 a 34 años\",\n  cglcol = \"pink\",\n  cglty = 2,\n  cglwd = 2,\n  plwd = 2,\n  pfcol = \"#EED3F180\" \n)\nradarchart(p28_34)\n\n```\n\n## 35 a 44\n\n```{r}\n#| code-fold: true\n#| warning: false\n\np35_44 <- radarchart(\n  a35_44_data,\n  title = \"De 35 a 44 años\",\n  cglcol = \"blue\",\n  cglty = 2,\n  cglwd = 2,\n  plwd = 2,\n  pfcol = \"#D3E3F180\"\n)\nradarchart(p35_44)\n\n```\n\n## 45 a 59\n\n```{r}\n#| code-fold: true\n#| warning: false\n\np45_59 <- radarchart(\n  a45_59_data,\n  title = \"De 45 a 59 años\",\n  cglcol = \"red\",\n  cglty = 2,\n  cglwd = 2,\n  plwd = 2,\n  pfcol = \"#EDBDBD80\" \n)\nradarchart(p45_59)\n\n```\n\n## Más de 60\n\n```{r}\n#| code-fold: true\n#| warning: false\n\npMas_60 <- radarchart(\n  aMas_60_data,\n  title = \"Más de 60 años\",\n  cglcol = \"purple\",\n  cglty = 2,\n  cglwd = 2,\n  plwd = 2,\n  pfcol = \"#D7BDED80\"  \n)\nradarchart(pMas_60)\n\n```\n\n:::\n\n## Procedimiento\n\nPara elaborar estos gráficos radiales (o spiderweb) con forma de diamante, he creado los dataframes mediante R, ya que eran pocos datos y no era muy costoso hacerlo a mano. Además, generé otro dataframe con los valores máximos registrados, estableciendo 0 como el valor mínimo. Una vez creados, los uní para obtener el dataframe con todos los datos necesarios.\n\nPosteriormente, filtré los dataframes por rango de edad y valores máximos y mínimos para crear los radarcharts. Me hubiera gustado colocarlos en formaciones de dos mediante la función \"#| layout-nrow: 2\", pero debido a algún problema con el paquete, probablemente se veían mal al reducir su tamaño. A pesar de mi preferencia, opté por utilizar panel-tabset.\n\n\n<br>\n\n----------------------\n\n<br>\n\n\n## Información sobre la sesión\n\nEntorno de trabajo y paquetes utilizados\n\n```{r}\n#| echo: false\nsessioninfo::session_info() %>% \n  details::details(summary = 'current session info') \n```\n\n","srcMarkdownNoYaml":"\n\n```{r}\n#| code-fold: true\n#| warning: false\n\n#install.packages(\"readxl\")\n#install.packages(\"highcharter\")\n#install.packages(\"leaflet\")\n#install.packages(\"osmdata\")\n#install.packages(\"fmsb\")\n\nlibrary(tidyverse)\nlibrary(dplyr)\nlibrary(readxl)\nlibrary(highcharter)\nlibrary(leaflet)\nlibrary(osmdata)\nlibrary(vembedr)\nlibrary(fmsb)\nlibrary(knitr)\n\n#Creo un objeto que contiene las fechas de lanzamientos de canciones y otro objeto con las fechas de los conciertos.\nfechas_lanzamiento <- as.Date(c(\"2022-07-28\", \"2022-08-25\", \"2022-10-27\", \"2023-04-06\", \"2023-05-25\", \"2023-07-06\", \"2023-10-10\", \"2023-12-07\"))\nfechas_lanzamiento <- as.numeric(as.POSIXct(fechas_lanzamiento, origin = \"1970-01-01\")) * 1000\n\nfechas_conciertos <- as.Date(c(\"2023-04-21\", \"2023-07-13\", \"2023-10-20\", \"2023-10-25\")) # Añade tus fechas de conciertos\nfechas_conciertos <- as.numeric(as.POSIXct(fechas_conciertos, origin = \"1970-01-01\")) * 1000\n\n\n```\n\n# Resumen del trabajo\n\nEste trabajo individual trata sobre el grupo de música \"Paco Te quiero\", del cual forma parte mi amigo Joan. Más adelante, se proporciona información detallada sobre este quinteto.\n\nPara la elaboración de todos los gráficos y materiales similares, he utilizado exclusivamente datos de Spotify for Artists. Obtener estos datos no fue tarea sencilla, y pude lograrlo mediante la capacidad de inspeccionar elementos (gráficos web) y limpiarlos con la función de buscar y seleccionar de Word.\n\n\n# Introducción del grupo\n\n[“Paco te quiero”](https://www.instagram.com/pacotequieroo/) es la respuesta a los días de bajona de cinco chavalas y chavales. Letras post adolescentes que giran en torno a las relaciones amorosas y destilan pesimismo, baja autoestima y en ocasiones antipatía. A través de melodías pop y sonidos que rozan el noise, tratan temas como la dependencia emocional, la salud mental o la responsabilidad afectiva. Bajona bailable al fin y al cabo. Recomendamos escuchar  [las canciones](https://open.spotify.com/intl-es/artist/5da84dECf86iCOP1dchjJc) andando de camino a tu casa cuando vuelves de fiesta y te entra la tristeza. \n\n## Integrantes del grupo\n\n```{r, echo=FALSE, out.width='100%'}\n#| code-fold: true\n#| warning: false\nknitr::include_graphics(\"imagenes/Integrantes.png\")\n```\n\nSus integrantes lo conforman cinco amigas y amigos. Gloria Ribas (voz), Lucía Matamoros (voz y guitarra), Frans Ribas (guitarra), Joan Martínez (bajo) y Pablo Robres (batería). Todos tienen algo en común y es que aman a Paco, el alter ego canallita del batería del grupo.\n\n# Datos sobre el grupo\n\n```{r}\n#| code-fold: true\n#| warning: false\n\n#Cargamos los datos que contienen las fuentes desde donde provienen cada una de las escuchas, oyentes distintos, escucha por oyente, guardados, playlists y seguidores\n\nEscuchas <-  read_excel(\"Datos/Escuchas.xlsx\")\nOyentes <-  read_excel(\"Datos/Oyentes.xlsx\")\nE_O <-  read_excel(\"Datos/E_O.xlsx\")\nGuardados <-  read_excel(\"Datos/Guardados.xlsx\")\nPlaylists <-  read_excel(\"Datos/Playlists.xlsx\")\nSeguidores <-  read_excel(\"Datos/Seguidores.xlsx\")\n\n#Transformamos el df para convertirlo en Tidy, convertimos los valores de la columna fecha a fecha y cambiamos los nombres.\n\nEscuchas <- pivot_longer(Escuchas, cols = -Fecha, names_to = \"Variable\", values_to = \"Valor\")\n\nEscuchas$Fecha <- as.Date(Escuchas$Fecha)\nEscuchas <- Escuchas[!is.na(Escuchas$Valor), ]\nEscuchas <- Escuchas %>%\n  mutate(Variable = case_when(\n    Variable == \"T_activas_E\" ~ \"Todas las fuentes activas\",\n    Variable == \"Cat_E\" ~ \"Catalogo y perfil de artista\",\n    Variable == \"Biblio_E\" ~ \"Biblioteca y listas del/de la oyente\",\n    Variable == \"Cola_E\" ~ \"Cola del/de la oyente\",\n    Variable == \"T_programadas_E\" ~ \"Todas las fuentes programadas\",\n    Variable == \"Editor_E\" ~ \"Listas editoriales\",\n    Variable == \"Mixes_E\" ~ \"Mixes y listas algorítmicas\",\n    Variable == \"Person_E\" ~ \"Listas editoriales personalizadas\",\n    Variable == \"De_otros_E\" ~ \"Listas de reproducción de otros oyentes\",\n    Variable == \"Radio_E\" ~ \"Radio y autoplay\",\n    Variable == \"Otros_E\" ~ \"Otros\",\n    Variable == \"Total_E\" ~ \"Escuchas totales por dia\"))\n\nOyentes <- pivot_longer(Oyentes, cols = -Fecha, names_to = \"Variable\", values_to = \"Valor\")\n\nOyentes$Fecha <- as.Date(Oyentes$Fecha)\nOyentes <- Oyentes[!is.na(Oyentes$Valor), ]\nOyentes <- Oyentes %>%\n  mutate(Variable = case_when(\n    Variable == \"T_activas_O\" ~ \"Todas las fuentes activas\",\n    Variable == \"Cat_O\" ~ \"Catalogo y perfil de artista\",\n    Variable == \"Biblio_O\" ~ \"Biblioteca y listas del/de la oyente\",\n    Variable == \"Cola_O\" ~ \"Cola del/de la oyente\",\n    Variable == \"T_programadas_O\" ~ \"Todas las fuentes programadas\",\n    Variable == \"Editor_O\" ~ \"Listas editoriales\",\n    Variable == \"Mixes_O\" ~ \"Mixes y listas algorítmicas\",\n    Variable == \"Person_O\" ~ \"Listas editoriales personalizadas\",\n    Variable == \"De_otros_O\" ~ \"Listas de reproducción de otros oyentes\",\n    Variable == \"Radio_O\" ~ \"Radio y autoplay\",\n    Variable == \"Otros_O\" ~ \"Otros\",\n    Variable == \"Total_O\" ~ \"Oyentes totales por dia\"))\n\nE_O <- pivot_longer(E_O, cols = -Fecha, names_to = \"Variable\", values_to = \"Valor\")\n\nE_O$Fecha <- as.Date(E_O$Fecha)\nE_O <- E_O[!is.na(E_O$Valor), ]\nE_O <- E_O %>%\n  mutate(Variable = case_when(\n    Variable == \"T_activas_E\" ~ \"Todas las fuentes activas\",\n    Variable == \"Cat_E\" ~ \"Catalogo y perfil de artista\",\n    Variable == \"Biblio_E\" ~ \"Biblioteca y listas del/de la oyente\",\n    Variable == \"Cola_E\" ~ \"Cola del/de la oyente\",\n    Variable == \"T_programadas_E\" ~ \"Todas las fuentes programadas\",\n    Variable == \"Editor_E\" ~ \"Listas editoriales\",\n    Variable == \"Mixes_E\" ~ \"Mixes y listas algorítmicas\",\n    Variable == \"Person_E\" ~ \"Listas editoriales personalizadas\",\n    Variable == \"De_otros_E\" ~ \"Listas de reproducción de otros oyentes\",\n    Variable == \"Radio_E\" ~ \"Radio y autoplay\",\n    Variable == \"Otros_E\" ~ \"Otros\"))\n\n#En estos casos solo hay un dato por fecha, por lo que no es necesario realizar grandes cambios.\n\nGuardados$Fecha <- as.Date(Guardados$Fecha)\n\nPlaylists$Fecha <- as.Date(Playlists$Fecha)\n\nSeguidores$Fecha <- as.Date(Seguidores$Fecha)\n\n```\n\nEn este apartado que recoge los principales datos diarios del grupo, podemos observar las fuentes desde donde se interactúa con el grupo, es decir, aspectos como las escuchas diarias totales, listas editoriales personalizadas y la cola del oyente. [Aquí](https://support.spotify.com/es/artists/article/source-of-streams/) se puede obtener más información sobre la clasificación que Spotify realiza al respecto. Esta información es bastante relevante, ya que permite conocer cuáles han sido o pueden ser los principales escaparates del grupo y en qué partes de Spotify se pueden llegar a nuevos oyentes o lograr que una canción se destaque.\n\n::: panel-tabset\n\n## Escuchas\n\n```{r}\n#| code-fold: true\n#| warning: false\n\n#Es prácticamente igual que en el caso anterior.Me parecía muy útil, ya que otras gráficas no permiten analizar temporalmente los datos.\n\np_ESC <- highchart(type = \"stock\") %>%\n  hc_add_series(Escuchas, \"line\", hcaes(x = Fecha, y = Valor, group = Variable)) %>%\n  hc_title(text = \"Composición de las escuchas\") %>%\n  hc_xAxis(\n    type = \"datetime\",\n    plotLines = c(\n      lapply(fechas_lanzamiento, function(x) list(\n        value = x,\n        width = 2,\n        color = \"red\"\n      )),\n      lapply(fechas_conciertos, function(x) list(\n        value = x,\n        width = 2,\n        color = \"yellow\"\n      ))\n    )\n  ) %>%  hc_yAxis(title = list(text = \"Valor\"), type = \"logarithmic\", minorTickInterval = \"auto\") %>%\n  hc_tooltip(shared = TRUE, crosshairs = TRUE) %>%\n  hc_exporting(enabled = TRUE) %>%\n  hc_rangeSelector(\n    enabled = TRUE,\n    selected = 4,\n    buttons = list(\n      list(type = 'month', count = 1, text = '1m'),\n      list(type = 'month', count = 3, text = '3m'),\n      list(type = 'month', count = 6, text = '6m'),\n      list(type = 'year', count = 1, text = '1y'),\n      list(type = 'all', text = 'Todo')\n    )\n  ) %>%\n  hc_navigator(enabled = TRUE) %>%  # Permite el desplazamiento en la barra inferior\n  hc_scrollbar(enabled = TRUE)  # Habilita la barra de desplazamiento\n\np_ESC\n\n```\n\n## Oyentes\n\n```{r}\n#| code-fold: true\n#| warning: false\n\np_OYE <- highchart(type = \"stock\") %>%\n  hc_add_series(Oyentes, \"line\", hcaes(x = Fecha, y = Valor, group = Variable)) %>%\n  hc_title(text = \"Composición de los oyentes\") %>%\n  hc_xAxis(\n    type = \"datetime\",\n    plotLines = c(\n      lapply(fechas_lanzamiento, function(x) list(\n        value = x,\n        width = 2,\n        color = \"red\"\n      )),\n      lapply(fechas_conciertos, function(x) list(\n        value = x,\n        width = 2,\n        color = \"yellow\"\n      ))\n    )\n  ) %>%  hc_yAxis(title = list(text = \"Valor\"), type = \"logarithmic\", minorTickInterval = \"auto\") %>%\n  hc_tooltip(shared = TRUE, crosshairs = TRUE) %>%\n  hc_exporting(enabled = TRUE) %>%\n  hc_rangeSelector(\n    enabled = TRUE,\n    selected = 4,\n    buttons = list(\n      list(type = 'month', count = 1, text = '1m'),\n      list(type = 'month', count = 3, text = '3m'),\n      list(type = 'month', count = 6, text = '6m'),\n      list(type = 'year', count = 1, text = '1y'),\n      list(type = 'all', text = 'Todo')\n    )\n  ) %>%\n  hc_navigator(enabled = TRUE) %>%  \n  hc_scrollbar(enabled = TRUE)  \n\np_OYE\n\n```\n\n## Escuchas/Oyentes\n\n```{r}\n#| code-fold: true\n#| warning: false\n\np_E_O_ <- highchart(type = \"stock\") %>%\n  hc_add_series(E_O, \"line\", hcaes(x = Fecha, y = Valor, group = Variable)) %>%\n  hc_title(text = \"Composición de los oyentes\") %>%\n  hc_xAxis(\n    type = \"datetime\",\n    plotLines = c(\n      lapply(fechas_lanzamiento, function(x) list(\n        value = x,\n        width = 2,\n        color = \"red\"\n      )),\n      lapply(fechas_conciertos, function(x) list(\n        value = x,\n        width = 2,\n        color = \"yellow\"\n      ))\n    )\n  ) %>%  hc_yAxis(title = list(text = \"Valor\"), type = \"logarithmic\", minorTickInterval = \"auto\") %>%\n  hc_tooltip(shared = TRUE, crosshairs = TRUE) %>%\n  hc_exporting(enabled = TRUE) %>%\n  hc_rangeSelector(\n    enabled = TRUE,\n    selected = 4,\n    buttons = list(\n      list(type = 'month', count = 1, text = '1m'),\n      list(type = 'month', count = 3, text = '3m'),\n      list(type = 'month', count = 6, text = '6m'),\n      list(type = 'year', count = 1, text = '1y'),\n      list(type = 'all', text = 'Todo')\n    )\n  ) %>%\n  hc_navigator(enabled = TRUE) %>%  \n  hc_scrollbar(enabled = TRUE)  \n\np_E_O_\n\n```\n\n## Guardados\n\n```{r}\n#| code-fold: true\n#| warning: false\n\np_GUAR <- highchart(type = \"stock\") %>%\n  hc_add_series(Guardados, \"line\", hcaes(x = Fecha, y = Valor_G), name = \"Nuevos guardados\") %>%\n  hc_title(text = \"Número de guardados por día\") %>%\n  hc_xAxis(\n    type = \"datetime\",\n    plotLines = c(\n      lapply(fechas_lanzamiento, function(x) list(\n        value = x,\n        width = 2,\n        color = \"red\"\n      )),\n      lapply(fechas_conciertos, function(x) list(\n        value = x,\n        width = 2,\n        color = \"yellow\"\n      ))\n    )\n  ) %>%  hc_yAxis(title = list(text = \"Valor\"), type = \"logarithmic\", minorTickInterval = \"auto\") %>%\n  hc_tooltip(shared = TRUE, crosshairs = TRUE) %>%\n  hc_exporting(enabled = TRUE) %>%\n  hc_rangeSelector(\n    enabled = TRUE,\n    selected = 4,\n    buttons = list(\n      list(type = 'month', count = 1, text = '1m'),\n      list(type = 'month', count = 3, text = '3m'),\n      list(type = 'month', count = 6, text = '6m'),\n      list(type = 'year', count = 1, text = '1y'),\n      list(type = 'all', text = 'Todo')\n    )\n  ) %>%\n  hc_navigator(enabled = TRUE) %>%  \n  hc_scrollbar(enabled = TRUE)  \n\np_GUAR\n\n```\n\n## Playlists\n\n```{r}\n#| code-fold: true\n#| warning: false\n\np_PLAY <- highchart(type = \"stock\") %>%\n  hc_add_series(Playlists, \"line\", hcaes(x = Fecha, y = Valor_P), name = \"Nuevas playlists\") %>%\n  hc_title(text = \"Número de guardados por día\") %>%\n  hc_xAxis(\n    type = \"datetime\",\n    plotLines = c(\n      lapply(fechas_lanzamiento, function(x) list(\n        value = x,\n        width = 2,\n        color = \"red\"\n      )),\n      lapply(fechas_conciertos, function(x) list(\n        value = x,\n        width = 2,\n        color = \"yellow\"\n      ))\n    )\n  ) %>%  hc_yAxis(title = list(text = \"Valor\"), type = \"logarithmic\", minorTickInterval = \"auto\") %>%\n  hc_tooltip(shared = TRUE, crosshairs = TRUE) %>%\n  hc_exporting(enabled = TRUE) %>%\n  hc_rangeSelector(\n    enabled = TRUE,\n    selected = 4,\n    buttons = list(\n      list(type = 'month', count = 1, text = '1m'),\n      list(type = 'month', count = 3, text = '3m'),\n      list(type = 'month', count = 6, text = '6m'),\n      list(type = 'year', count = 1, text = '1y'),\n      list(type = 'all', text = 'Todo')\n    )\n  ) %>%\n  hc_navigator(enabled = TRUE) %>%  \n  hc_scrollbar(enabled = TRUE)  \n\np_PLAY\n\n```\n\n## Seguidores\n\n```{r}\n#| code-fold: true\n#| warning: false\n\np_SEG <- highchart(type = \"stock\") %>%\n  hc_add_series(Seguidores, \"line\", hcaes(x = Fecha, y = Valor_S), name = \"Seguidores totales\") %>%\n  hc_title(text = \"Nº de seguidores totales\") %>%\n  hc_xAxis(\n    type = \"datetime\",\n    plotLines = c(\n      lapply(fechas_lanzamiento, function(x) list(\n        value = x,\n        width = 2,\n        color = \"red\"\n      )),\n      lapply(fechas_conciertos, function(x) list(\n        value = x,\n        width = 2,\n        color = \"yellow\"\n      ))\n    )\n  ) %>%  hc_yAxis(title = list(text = \"Valor\"), type = \"logarithmic\", minorTickInterval = \"auto\") %>%\n  hc_tooltip(shared = TRUE, crosshairs = TRUE) %>%\n  hc_exporting(enabled = TRUE) %>%\n  hc_rangeSelector(\n    enabled = TRUE,\n    selected = 4,\n    buttons = list(\n      list(type = 'month', count = 1, text = '1m'),\n      list(type = 'month', count = 3, text = '3m'),\n      list(type = 'month', count = 6, text = '6m'),\n      list(type = 'year', count = 1, text = '1y'),\n      list(type = 'all', text = 'Todo')\n    )\n  ) %>%\n  hc_navigator(enabled = TRUE) %>%  \n  hc_scrollbar(enabled = TRUE)  \n\np_SEG\n\n```\n\n## Procedimiento\n\nEl procedimiento ha sido muy similar al de los datos de las canciones. Se consideró utilizar otro tipo de gráfico, pero por un lado, es difícil hacerlo amigable con tantos datos y, por otro, podría romper un poco con la estética de la página.\n\nEstá explicado en el procedimiento de los datos de las canciones.\n\n:::\n\n# Algunas canciones del grupo\n\n## Demolición\n\nEs el segundo adelanto del EP: [‘Adultas depende del día’](https://open.spotify.com/intl-es/album/4f20lPAxbiIpWXrxP1cCp1). A medida que una se convierte en adulta, el concepto de noche cambia. Lo que antes era un simple divertimento, ahora se ha convertido en una vía de escape. De eso va ‘demolición’. De excesos, de falta de amor propio, de adicciones, de descontrol. Del momento exacto en el que uno se da cuenta de que todo ha cambiado.\n\n```{r, out.extra=c('allow=\"encrypted-media\"', 'allowtransparency=\"true\"', 'frameBorder=\"0\"')}\n#| code-fold: true\n#| warning: false\n\nknitr::include_url(\"https://open.spotify.com/embed/track/61FPKErHn6wh4eGYe9FGTk?utm_source=generator\", height = \"152\")\n```\n\n\n## Becariasoy@gmail.com\n\nHas acabado la carrera. 4 años. Has encontrado prácticas. Son en Madrid. Tú eres de Barcelona. Pero da igual, decides ir. Va bien. Te ascienden. Ahora eres creativo. Te habla tu ex. La de toda la vida. A la cual sigues queriendo. Quedas con ella. Te vuelve a dejar. Y al día siguiente has de ir a trabajar. Y no puedes. Y crees que es temporal. Pero no. A la semana siguiente tampoco puedes. Ni al mes. Lo has dejado todo atrás. Y simplemente no puedes. Y entonces escribo [becariasoy@gmail.com](https://open.spotify.com/intl-es/track/3XCAMyvSxB1XS2LvTnHb90). Y me mudo a Barcelona y la componemos. Guitarra Shoegaze, melodía Pop, estructura Indie; Nuestro nuevo sonido.\n\n```{r, out.extra=c('allow=\"encrypted-media\"', 'allowtransparency=\"true\"', 'frameBorder=\"0\"')}\n#| code-fold: true\n#| warning: false\n\nknitr::include_url(\"https://open.spotify.com/embed/track/3XCAMyvSxB1XS2LvTnHb90?utm_source=generator&theme=0\", height = \"152\")\n\n```\n\n## Bajona de verano\n\nTrata de abordar el tema de la dependencia emocional. La canción está escrita a través del punto de vista de un personaje, el cual siempre ha recurrido al cariño de la misma persona para animarse y recuperarse en los momentos de bajona. Esta vez, esa persona no está, por lo que por primera vez, deberá enfrentarse a sus fantasmas en solitario, y le resulta imposible.\n\n```{r}\n#| code-fold: true\n#| warning: false\n\n#| echo = FALSE,\n#| out.width = \"100%\"\nembed_url(\"https://www.youtube.com/watch?v=Hef7bAt3BWA\")\n\n```\n\n# Datos comparando canciones por días\n\n```{r}\n#| code-fold: true\n#| warning: false\n\nA <-  read_excel(\"Datos/A.xlsx\")\nL <-  read_excel(\"Datos/L.xlsx\")\nBe <-  read_excel(\"Datos/Be.xlsx\")\nP <-  read_excel(\"Datos/P.xlsx\")\nH <-  read_excel(\"Datos/H.xlsx\")\nBa <-  read_excel(\"Datos/Ba.xlsx\")\nM <-  read_excel(\"Datos/M.xlsx\")\nD <-  read_excel(\"Datos/D.xlsx\")\n\n#De esta manera agrupo los df en uno para tener la informacion junta con los datos de todas las canciones.\ndf_total <- Reduce(function(x, y) merge(x, y, by = \"Fecha\", all = TRUE), \n                    list(A, L, Be, P, H, Ba, M, D))\n\n#Creo estos objetos para poder filtrar las columnas que me interesan.\nc_escuchas <- grep(\"Escuchas\", names(df_total), value = TRUE)\nc_oyentes <- grep(\"Oyentes\", names(df_total), value = TRUE)\nc_e_o <- grep(\"E_O\", names(df_total), value = TRUE)\nc_playlists <- grep(\"N_playlists\", names(df_total), value = TRUE)\nc_guardados <- grep(\"N_Guardados\", names(df_total), value = TRUE)\n\n#Creo un df por cada dato que agrupe todas las canciones y hago pivot longer para que sea tidy y se pueda implementar en los gráficos (una columna para la serie, otra para el eje x y otra para el eje y). También aprovecho para cambiar los nombres.\n#Podría haber cambiado los nombres previamente, pero para mi era menos liante establecer los nombre una vez obtenidos los df.\ndf_escuchas <- df_total[, c(\"Fecha\", c_escuchas)]\ndf_escuchas <- pivot_longer(df_escuchas, cols = -Fecha, names_to = \"Variable\", values_to = \"Valor\")\n\ndf_escuchas$Fecha <- as.Date(df_escuchas$Fecha)\ndf_escuchas <- df_escuchas[!is.na(df_escuchas$Valor), ]\ndf_escuchas <- df_escuchas %>%\n  mutate(Variable = case_when(\n    Variable == \"Escuchas_H\" ~ \"Hoy (Lo siento)\",\n    Variable == \"Escuchas_M\" ~ \"Momento Funesto\",\n    Variable == \"Escuchas_Ba\" ~ \"Bajona de Verano\",\n    Variable == \"Escuchas_P\" ~ \"pase lo que pase\",\n    Variable == \"Escuchas_D\" ~ \"demolicion\",\n    Variable == \"Escuchas_Be\" ~ \"becariasoy@gmail.com\",\n    Variable == \"Escuchas_L\" ~ \"Lo Que Haces Siempre\",\n    Variable == \"Escuchas_A\" ~ \"Aunque Tenga Miedo\"))\n\ndf_oyentes <- df_total[, c(\"Fecha\", c_oyentes)]\ndf_oyentes <- pivot_longer(df_oyentes, cols = -Fecha, names_to = \"Variable\", values_to = \"Valor\")\n\ndf_oyentes$Fecha <- as.Date(df_oyentes$Fecha)\ndf_oyentes <- df_oyentes[!is.na(df_oyentes$Valor), ]\ndf_oyentes <- df_oyentes %>%\n  mutate(Variable = case_when(\n    Variable == \"Oyentes_H\" ~ \"Hoy (Lo siento)\",\n    Variable == \"Oyentes_M\" ~ \"Momento Funesto\",\n    Variable == \"Oyentes_Ba\" ~ \"Bajona de Verano\",\n    Variable == \"Oyentes_P\" ~ \"pase lo que pase\",\n    Variable == \"Oyentes_D\" ~ \"demolicion\",\n    Variable == \"Oyentes_Be\" ~ \"becariasoy@gmail.com\",\n    Variable == \"Oyentes_L\" ~ \"Lo Que Haces Siempre\",\n    Variable == \"Oyentes_A\" ~ \"Aunque Tenga Miedo\"))\n\ndf_e_o <- df_total[, c(\"Fecha\", c_e_o)]\ndf_e_o <- pivot_longer(df_e_o, cols = -Fecha, names_to = \"Variable\", values_to = \"Valor\")\n\ndf_e_o$Fecha <- as.Date(df_e_o$Fecha)\ndf_e_o <- df_e_o[!is.na(df_e_o$Valor), ]\ndf_e_o <- df_e_o %>%\n  mutate(Variable = case_when(\n    Variable == \"E_O_H\" ~ \"Hoy (Lo siento)\",\n    Variable == \"E_O_M\" ~ \"Momento Funesto\",\n    Variable == \"E_O_Ba\" ~ \"Bajona de Verano\",\n    Variable == \"E_O_P\" ~ \"pase lo que pase\",\n    Variable == \"E_O_D\" ~ \"demolicion\",\n    Variable == \"E_O_Be\" ~ \"becariasoy@gmail.com\",\n    Variable == \"E_O_L\" ~ \"Lo Que Haces Siempre\",\n    Variable == \"E_O_A\" ~ \"Aunque Tenga Miedo\"))\n\ndf_e_o <- df_total[, c(\"Fecha\", c_e_o)]\ndf_e_o <- pivot_longer(df_e_o, cols = -Fecha, names_to = \"Variable\", values_to = \"Valor\")\n\ndf_e_o$Fecha <- as.Date(df_e_o$Fecha)\ndf_e_o <- df_e_o[!is.na(df_e_o$Valor), ]\ndf_e_o <- df_e_o %>%\n  mutate(Variable = case_when(\n    Variable == \"E_O_H\" ~ \"Hoy (Lo siento)\",\n    Variable == \"E_O_M\" ~ \"Momento Funesto\",\n    Variable == \"E_O_Ba\" ~ \"Bajona de Verano\",\n    Variable == \"E_O_P\" ~ \"pase lo que pase\",\n    Variable == \"E_O_D\" ~ \"demolicion\",\n    Variable == \"E_O_Be\" ~ \"becariasoy@gmail.com\",\n    Variable == \"E_O_L\" ~ \"Lo Que Haces Siempre\",\n    Variable == \"E_O_A\" ~ \"Aunque Tenga Miedo\"))\n\ndf_playlists <- df_total[, c(\"Fecha\", c_playlists)]\ndf_playlists <- pivot_longer(df_playlists, cols = -Fecha, names_to = \"Variable\", values_to = \"Valor\")\n\ndf_playlists$Fecha <- as.Date(df_playlists$Fecha)\ndf_playlists <- df_playlists[!is.na(df_playlists$Valor), ]\ndf_playlists <- df_playlists %>%\n  mutate(Variable = case_when(\n    Variable == \"N_playlists_H\" ~ \"Hoy (Lo siento)\",\n    Variable == \"N_playlists_M\" ~ \"Momento Funesto\",\n    Variable == \"N_playlists_Ba\" ~ \"Bajona de Verano\",\n    Variable == \"N_playlists_P\" ~ \"pase lo que pase\",\n    Variable == \"N_playlists_D\" ~ \"demolicion\",\n    Variable == \"N_playlists_Be\" ~ \"becariasoy@gmail.com\",\n    Variable == \"N_playlists_L\" ~ \"Lo Que Haces Siempre\",\n    Variable == \"N_playlists_A\" ~ \"Aunque Tenga Miedo\"))\n\ndf_guardados <- df_total[, c(\"Fecha\", c_guardados)]\ndf_guardados <- pivot_longer(df_guardados, cols = -Fecha, names_to = \"Variable\", values_to = \"Valor\")\n\ndf_guardados$Fecha <- as.Date(df_guardados$Fecha)\ndf_guardados <- df_guardados[!is.na(df_guardados$Valor), ]\ndf_guardados <- df_guardados %>%\n  mutate(Variable = case_when(\n    Variable == \"N_Guardados_H\" ~ \"Hoy (Lo siento)\",\n    Variable == \"N_Guardados_M\" ~ \"Momento Funesto\",\n    Variable == \"N_Guardados_Ba\" ~ \"Bajona de Verano\",\n    Variable == \"N_Guardados_P\" ~ \"pase lo que pase\",\n    Variable == \"N_Guardados_D\" ~ \"demolicion\",\n    Variable == \"N_Guardados_Be\" ~ \"becariasoy@gmail.com\",\n    Variable == \"N_Guardados_L\" ~ \"Lo Que Haces Siempre\",\n    Variable == \"N_Guardados_A\" ~ \"Aunque Tenga Miedo\"))\n\n#Aunque lo anterior parezca una redundancia por cambiar los nombre cada vez, para mí es mucho más limpio y me permite organizarme mejor en caso de querer realizar cambios.\n\n```\n\nEn este apartado, se han analizado los datos diarios de las canciones del grupo y se han separado en 6 gráficos interactivos. Estos contienen el número de escuchas, oyentes, escuchas por oyente, playlists y guardados. Se han añadido barras rojas verticales que representan el lanzamiento de una nueva canción y barras amarillas que muestran la fecha de un concierto, facilitando la observación de su influencia de manera clara.\n\nEs importante destacar los gráficos del paquete Highcharter (se requiere una licencia), ya que permiten seleccionar un rango de fechas específico y desplazarse a lo largo del tiempo mediante la barra inferior. También permiten visualizar el número concreto de cada serie en un día específico al arrastrar el cursor, descargar una imagen y acceder a los datos, entre otras funcionalidades.\n\n::: panel-tabset\n\n## Escuchas\n\n```{r}\n#| code-fold: true\n#| warning: false\n\n#Para elaborar los gráficos he utilizado el paquete highcharter de la empresa Highchart (es muy utilizado en páginas web con gréficos de activos)\n\n#Este software no es libre para el uso comercial, pero si que permiten su uso bajo en el ámbito académico (Adjunto la licencia en la carpeta)\n\n#He realizado un gráfico por tipo de dato con todas las canciones.\n\np_escuchas <- highchart(type = \"stock\") %>%\n  hc_add_series(df_escuchas, \"line\", hcaes(x = Fecha, y = Valor, group = Variable)) %>% \n\n#de esta manera puedo añadir una serie junto a los ejes agrupando el color por canciones\n  \n  hc_title(text = \"Numero de escuchas por canción\") %>%\n  hc_xAxis(\n    type = \"datetime\", \n\n#He utilizado esta función para añadir una linea vertical de color rojo en el caso de lanzamientos de canciones y amarillo en el caso de conciertos.\n\n    plotLines = c(\n      lapply(fechas_lanzamiento, function(x) list(\n        value = x,\n        width = 2,\n        color = \"red\"\n      )),\n      lapply(fechas_conciertos, function(x) list(\n        value = x,\n        width = 2,\n        color = \"yellow\"\n      ))\n    )\n  ) %>%  hc_yAxis(title = list(text = \"Valor\"), type = \"logarithmic\", minorTickInterval = \"auto\") %>%\n  hc_tooltip(shared = TRUE, crosshairs = TRUE) %>%\n  hc_exporting(enabled = TRUE) %>%\n  hc_rangeSelector(\n    enabled = TRUE,\n    selected = 4,\n    buttons = list(\n      list(type = 'month', count = 1, text = '1m'),\n      list(type = 'month', count = 3, text = '3m'),\n      list(type = 'month', count = 6, text = '6m'),\n      list(type = 'year', count = 1, text = '1y'),\n      list(type = 'all', text = 'Todo')\n    ) \n\n#Gracias a esta herramienta se puede seleccionar la temporalidad manualmente.\n\n  ) %>%\n  hc_navigator(enabled = TRUE) %>%  \n\n# Permite un desplazamiento en la barra inferior\n  \n  hc_scrollbar(enabled = TRUE)  \n\n# Habilita la barra de desplazamiento\n\np_escuchas\n\n```\n\n## Oyentes\n\n```{r}\n#| code-fold: true\n#| warning: false\n\np_oyentes <- highchart(type = \"stock\") %>%\n  hc_add_series(df_oyentes, \"line\", hcaes(x = Fecha, y = Valor, group = Variable)) %>%\n  hc_title(text = \"Numero de Oyentes por canción\") %>%\n  hc_xAxis(\n    type = \"datetime\",\n    plotLines = c(\n      lapply(fechas_lanzamiento, function(x) list(\n        value = x,\n        width = 2,\n        color = \"red\"\n      )),\n      lapply(fechas_conciertos, function(x) list(\n        value = x,\n        width = 2,\n        color = \"yellow\"\n      ))\n    )\n  ) %>%  hc_yAxis(title = list(text = \"Valor\"), type = \"logarithmic\", minorTickInterval = \"auto\") %>%\n  hc_tooltip(shared = TRUE, crosshairs = TRUE) %>%\n  hc_exporting(enabled = TRUE) %>%\n  hc_rangeSelector(\n    enabled = TRUE,\n    selected = 4,\n    buttons = list(\n      list(type = 'month', count = 1, text = '1m'),\n      list(type = 'month', count = 3, text = '3m'),\n      list(type = 'month', count = 6, text = '6m'),\n      list(type = 'year', count = 1, text = '1y'),\n      list(type = 'all', text = 'Todo')\n    )\n  ) %>%\n  hc_navigator(enabled = TRUE) %>%  \n  hc_scrollbar(enabled = TRUE)  \n\np_oyentes\n\n```\n\n## Escuchas/Oyentes\n\n```{r}\n#| code-fold: true\n#| warning: false\n\np_e_o <- highchart(type = \"stock\") %>%\n  hc_add_series(df_e_o, \"line\", hcaes(x = Fecha, y = Valor, group = Variable)) %>%\n  hc_title(text = \"Numero de Escuchas/Oyentes por canción\") %>%\n  hc_xAxis(\n    type = \"datetime\",\n    plotLines = c(\n      lapply(fechas_lanzamiento, function(x) list(\n        value = x,\n        width = 2,\n        color = \"red\"\n      )),\n      lapply(fechas_conciertos, function(x) list(\n        value = x,\n        width = 2,\n        color = \"yellow\"\n      ))\n    )\n  ) %>%  hc_yAxis(title = list(text = \"Valor\"), type = \"logarithmic\", minorTickInterval = \"auto\") %>%\n  hc_tooltip(shared = TRUE, crosshairs = TRUE) %>%\n  hc_exporting(enabled = TRUE) %>%\n  hc_rangeSelector(\n    enabled = TRUE,\n    selected = 4,\n    buttons = list(\n      list(type = 'month', count = 1, text = '1m'),\n      list(type = 'month', count = 3, text = '3m'),\n      list(type = 'month', count = 6, text = '6m'),\n      list(type = 'year', count = 1, text = '1y'),\n      list(type = 'all', text = 'Todo')\n    )\n  ) %>%\n  hc_navigator(enabled = TRUE) %>%  \n  hc_scrollbar(enabled = TRUE)  \n\np_e_o\n\n```\n\n## Playlists\n\n```{r}\n#| code-fold: true\n#| warning: false\n\np_playlists <- highchart(type = \"stock\") %>%\n  hc_add_series(df_playlists, \"line\", hcaes(x = Fecha, y = Valor, group = Variable)) %>%\n  hc_title(text = \"Numero de Playlists nuevas por canción\") %>%\n  hc_xAxis(\n    type = \"datetime\",\n    plotLines = c(\n      lapply(fechas_lanzamiento, function(x) list(\n        value = x,\n        width = 2,\n        color = \"red\"\n      )),\n      lapply(fechas_conciertos, function(x) list(\n        value = x,\n        width = 2,\n        color = \"yellow\"\n      ))\n    )\n  ) %>%  hc_yAxis(title = list(text = \"Valor\"), type = \"logarithmic\", minorTickInterval = \"auto\") %>%\n  hc_tooltip(shared = TRUE, crosshairs = TRUE) %>%\n  hc_exporting(enabled = TRUE) %>%\n  hc_rangeSelector(\n    enabled = TRUE,\n    selected = 4,\n    buttons = list(\n      list(type = 'month', count = 1, text = '1m'),\n      list(type = 'month', count = 3, text = '3m'),\n      list(type = 'month', count = 6, text = '6m'),\n      list(type = 'year', count = 1, text = '1y'),\n      list(type = 'all', text = 'Todo')\n    )\n  ) %>%\n  hc_navigator(enabled = TRUE) %>%  \n  hc_scrollbar(enabled = TRUE)  \n\np_playlists\n\n```\n\n## Guardados\n\n```{r}\n#| code-fold: true\n#| warning: false\n\np_guardados <- highchart(type = \"stock\") %>%\n  hc_add_series(df_guardados, \"line\", hcaes(x = Fecha, y = Valor, group = Variable)) %>%\n  hc_title(text = \"Numero de nuevos Guardados por canción\") %>%\n  hc_xAxis(\n    type = \"datetime\",\n    plotLines = c(\n      lapply(fechas_lanzamiento, function(x) list(\n        value = x,\n        width = 2,\n        color = \"red\"\n      )),\n      lapply(fechas_conciertos, function(x) list(\n        value = x,\n        width = 2,\n        color = \"yellow\"\n      ))\n    )\n  ) %>%  hc_yAxis(title = list(text = \"Valor\"), type = \"logarithmic\", minorTickInterval = \"auto\") %>%\n  hc_tooltip(shared = TRUE, crosshairs = TRUE) %>%\n  hc_exporting(enabled = TRUE) %>%\n  hc_rangeSelector(\n    enabled = TRUE,\n    selected = 4,\n    buttons = list(\n      list(type = 'month', count = 1, text = '1m'),\n      list(type = 'month', count = 3, text = '3m'),\n      list(type = 'month', count = 6, text = '6m'),\n      list(type = 'year', count = 1, text = '1y'),\n      list(type = 'all', text = 'Todo')\n    )\n  ) %>%\n  hc_navigator(enabled = TRUE) %>%  \n  hc_scrollbar(enabled = TRUE)  \n\np_guardados\n\n```\n\n## Procedimiento\n\nPara elaborar este gráfico, en primer lugar, se obtuvieron los datos, una tarea que ocupó la mayor parte del tiempo. En Spotify for Artists solo se pueden descargar los datos de las escuchas, y como no se quería hacer uso de la API key, fue necesario utilizar \"inspeccionar elemento\" en el gráfico de cada canción (un gráfico por cada tipo de número). Una vez encontrada la parte del código que contenía los datos, se copiaron y pegaron en Word para utilizar la herramienta de buscar y seleccionar, dejando únicamente los datos con sus fechas. Posteriormente, se pegaron los datos ya ordenados en una hoja de Excel.\n\nPara desarrollarlos, se separaron los dataframes según el gráfico que se deseaba obtener. Se convirtieron las columnas con los nombres de las canciones (series) en una sola columna, los datos (eje y) en otra mediante pivot longer y se utilizó la columna de fecha como eje x. En cuanto al Highchart, se destaca que está en escala logarítmica para reducir las diferencias visuales y apreciar mejor los cambios y pequeños detalles. También se añadieron todas las herramientas externas, como la elección de la temporalidad.\n\n:::\n\n# Comparación entre canciones (No temporal)\n\n```{r}\n#| code-fold: true\n#| warning: false\n\n#Aquí encontramos estadísticas básicas como máximo, mediana y desviación típica, según escuchas, oyentes, playlists y guardados. \n\nCompar_E <-  read_excel(\"Datos/Compar_E.xlsx\")\nCompar_O <-  read_excel(\"Datos/Compar_O.xlsx\")\nCompar_P <-  read_excel(\"Datos/Compar_P.xlsx\")\nCompar_G <-  read_excel(\"Datos/Compar_G.xlsx\")\n\n#En este caso lo he convertido a tidy y he convertifo los valores de la desviación típica a porcentaje.\n\nCompar_E <- pivot_longer(Compar_E, cols = -Cancion, names_to = \"Variable\", values_to = \"Valor\") %>%\n  mutate(Valor = ifelse(Variable == \"Desviacion_tipica\", Valor * 100, Valor)) %>%\n  mutate(Valor = as.numeric(Valor))  # Convertir a numérico \n\nCompar_O <- pivot_longer(Compar_O, cols = -Cancion, names_to = \"Variable\", values_to = \"Valor\") %>%\n  mutate(Valor = ifelse(Variable == \"Desviacion_tipica\", Valor * 100, Valor)) %>%\n  mutate(Valor = as.numeric(Valor))  \n\nCompar_P <- pivot_longer(Compar_P, cols = -Cancion, names_to = \"Variable\", values_to = \"Valor\") %>%\n  mutate(Valor = ifelse(Variable == \"Desviacion_tipica\", Valor * 100, Valor)) %>%\n  mutate(Valor = as.numeric(Valor))  \n\nCompar_G <- pivot_longer(Compar_G, cols = -Cancion, names_to = \"Variable\", values_to = \"Valor\") %>%\n  mutate(Valor = ifelse(Variable == \"Desviacion_tipica\", Valor * 100, Valor)) %>%\n  mutate(Valor = as.numeric(Valor))  \n\n#Convierto los valores a absolutos para evitar decimales muy largos de la desviación típica\n\nCompar_E <- transform(Compar_E, Valor = abs(Valor))\n\nCompar_E$Valor <- as.integer(Compar_E$Valor)\n\n#He convertido los df a gráficos de barra, dónde las barras se agrupan por canciones y se subdividen por colores según la métrica.\n\np_COMP_E <- hchart(Compar_E, \"column\", hcaes(x = Cancion, y = Valor, group = Variable)) %>%\n  hc_plotOptions(column = list(\n    dataLabels = list(\n      enabled = TRUE,\n      formatter = JS(\"function() {\n                     if (this.series.name === 'Desviacion_tipica') {\n                        return Highcharts.numberFormat(this.y, 1) + '%';\n                     } else {\n                        return Highcharts.numberFormat(this.y, 1);\n                     }\n                  }\")\n    ),\n    grouping = TRUE,\n    shadow = FALSE\n  )) %>%\n  hc_title(text = \"Comparación de Escuchas entre canciones\") %>%\n  hc_xAxis(title = list(text = \"Canción\")) %>%\n  hc_yAxis(title = list(text = \"Valor\"), type = \"logarithmic\", minorTickInterval = \"auto\") %>%\n  hc_legend(enabled = FALSE)  # Ocultar la leyenda\n\nCompar_O <- transform(Compar_O, Valor = abs(Valor))\n\nCompar_O$Valor <- as.integer(Compar_O$Valor)\n\np_COMP_O <- hchart(Compar_O, \"column\", hcaes(x = Cancion, y = Valor, group = Variable)) %>%\n  hc_plotOptions(column = list(\n    dataLabels = list(\n      enabled = TRUE,\n      formatter = JS(\"function() {\n                     if (this.series.name === 'Desviacion_tipica') {\n                        return Highcharts.numberFormat(this.y, 1) + '%';\n                     } else {\n                        return Highcharts.numberFormat(this.y, 1);\n                     }\n                  }\")\n    ),\n    grouping = TRUE,\n    shadow = FALSE\n  )) %>%\n  hc_title(text = \"Comparación de Oyentes entre canciones\") %>%\n  hc_xAxis(title = list(text = \"Canción\")) %>%\n  hc_yAxis(title = list(text = \"Valor\"), type = \"logarithmic\", minorTickInterval = \"auto\") %>%\n  hc_legend(enabled = FALSE)  # Ocultar la leyenda\n\nCompar_P <- transform(Compar_P, Valor = abs(Valor))\n\nCompar_P$Valor <- as.integer(Compar_P$Valor)\n\np_COMP_P <- hchart(Compar_P, \"column\", hcaes(x = Cancion, y = Valor, group = Variable)) %>%\n  hc_plotOptions(column = list(\n    dataLabels = list(\n      enabled = TRUE,\n      formatter = JS(\"function() {\n                     if (this.series.name === 'Desviacion_tipica') {\n                        return Highcharts.numberFormat(this.y, 1) + '%';\n                     } else {\n                        return Highcharts.numberFormat(this.y, 1);\n                     }\n                  }\")\n    ),\n    grouping = TRUE,\n    shadow = FALSE\n  )) %>%\n  hc_title(text = \"Comparación de Playlists entre canciones\") %>%\n  hc_xAxis(title = list(text = \"Canción\")) %>%\n  hc_yAxis(title = list(text = \"Valor\"), type = \"logarithmic\", minorTickInterval = \"auto\") %>%\n  hc_legend(enabled = FALSE)  # Ocultar la leyenda\n\np_COMP_G <- hchart(Compar_G, \"column\", hcaes(x = Cancion, y = Valor, group = Variable)) %>%\n  hc_plotOptions(column = list(\n    dataLabels = list(\n      enabled = TRUE,\n      formatter = JS(\"function() {\n                     if (this.series.name === 'Desviacion_tipica') {\n                        return Highcharts.numberFormat(this.y, 1) + '%';\n                     } else {\n                        return Highcharts.numberFormat(this.y, 1);\n                     }\n                  }\")\n    ),\n    grouping = TRUE,\n    shadow = FALSE\n  )) %>%\n  hc_title(text = \"Comparación de Guardados entre canciones\") %>%\n  hc_xAxis(title = list(text = \"Canción\")) %>%\n  hc_yAxis(title = list(text = \"Valor\"), type = \"logarithmic\", minorTickInterval = \"auto\") %>%\n  hc_legend(enabled = FALSE)  # Ocultar la leyenda\n\n```\n\nEn estos gráficos, podemos observar diferencias estadísticas entre las canciones para tener una visión más general. Estos datos incluyen el máximo histórico, la desviación típica sobre su media para determinar cuáles son las canciones con más estabilidad y cuáles son más fluctuantes, y por último, la mediana, que es más representativa que la media (aunque tiene cierta distorsión, ya que las canciones más nuevas tienden a tener una mayor).\n\nPara esta comparación, he utilizado un gráfico de barras, ya que considero que es la mejor herramienta para comparar pocos datos que no tienen una serie temporal.\n\n::: panel-tabset\n\n## Escuchas\n\n```{r}\n#| code-fold: true\n#| warning: false  \n#| column: screen-inset-shaded\n#| layout-nrow: 2\n\npar(mfrow = c(2, 2))\n\np_COMP_E\n\np_COMP_O\n\np_COMP_P\n\np_COMP_G\n\n```\n\n\n## Procedimiento\n\nEn primer lugar, he tenido que realizar un pivot longer para tener un dataframe tidy. También he convertido a porcentaje los valores de la desviación típica. Una vez obtenidos los dataframes, he creado los gráficos con Highcharter. En ellos, he añadido el símbolo % a los valores de desviación típica y he convertido los gráficos a una escala logarítmica, ya que había una gran diferencia entre los valores máximos y la mediana.\n\n:::\n\n# Mapa geográfico de los oyentes\n\n```{r}\n#| code-fold: true\n#| warning: false\n\n#Este ha sido un trabajo arduo, pues con la herramienta osmdata he conseguido las coordenadas da cada una de las 48 ciudades con más oyentes del mundo en los últimos 28 días. Creando un punto medio y añadiendo a un df las longitudes y latitudes obtenidas he podido lograr el df requerido para hacer el leaflet.\n\n# coords_barcelona <- osmdata::getbb(\"Barcelona, Spain\", format_out = \"matrix\")\n# coords_madrid <- osmdata::getbb(\"Madrid, Spain\", format_out = \"matrix\")\n# coords_valencia <- osmdata::getbb(\"Valencia, Spain\", format_out = \"matrix\")\n# coords_zaragoza <- osmdata::getbb(\"Zaragoza, Spain\", format_out = \"matrix\")\n# coords_malaga <- osmdata::getbb(\"Málaga, Spain\", format_out = \"matrix\")\n# coords_bilbao <- osmdata::getbb(\"Bilbao, Spain\", format_out = \"matrix\")\n# coords_sevilla <- osmdata::getbb(\"Sevilla, Spain\", format_out = \"matrix\")\n# coords_valladolid <- osmdata::getbb(\"Valladolid, Spain\", format_out = \"matrix\")\n# coords_murcia <- osmdata::getbb(\"Murcia, Spain\", format_out = \"matrix\")\n# coords_alicante <- osmdata::getbb(\"Alicante, Spain\", format_out = \"matrix\")\n# coords_vigo <- osmdata::getbb(\"Vigo, Spain\", format_out = \"matrix\")\n# coords_la_corunya <- osmdata::getbb(\"La Coruña, Spain\", format_out = \"matrix\")\n# coords_buenos_aires <- osmdata::getbb(\"Buenos Aires, Argentina\", format_out = \"matrix\")\n# coords_bogota <- osmdata::getbb(\"Bogotá, Colombia\", format_out = \"matrix\")\n# coords_santiago_de_chile <- osmdata::getbb(\"Santiago de Chile, Chile\", format_out = \"matrix\")\n# coords_vitoria <- osmdata::getbb(\"Vitoria, Spain\", format_out = \"matrix\")\n# coords_alcala <- osmdata::getbb(\"Alcalá de Henares, Spain\", format_out = \"matrix\")\n# coords_granada <- osmdata::getbb(\"Granada, Spain\", format_out = \"matrix\")\n# coords_santiago_de_compostela <- osmdata::getbb(\"Santiago de Compostela, Spain\", format_out = \"matrix\")\n# coords_sanse <- osmdata::getbb(\"San Sebastián, Spain\", format_out = \"matrix\")\n# coords_pamplona <- osmdata::getbb(\"Pamplona, Spain\", format_out = \"matrix\")\n# coords_sant_cugat <- osmdata::getbb(\"Sant Cugat, Spain\", format_out = \"matrix\")\n# coords_albacete <- osmdata::getbb(\"Albacete, Spain\", format_out = \"matrix\")\n# coords_lima <- osmdata::getbb(\"Lima, Peru\", format_out = \"matrix\")\n# coords_elche <- osmdata::getbb(\"Elche, Spain\", format_out = \"matrix\")\n# coords_salamanca <- osmdata::getbb(\"Salamanca, Spain\", format_out = \"matrix\")\n# coords_gijon <- osmdata::getbb(\"Gijón, Spain\", format_out = \"matrix\")\n# coords_sabadell <- osmdata::getbb(\"Sabadell, Spain\", format_out = \"matrix\")\n# coords_leon <- osmdata::getbb(\"León, Spain\", format_out = \"matrix\")\n# coords_palencia <- osmdata::getbb(\"Palencia, Spain\", format_out = \"matrix\")\n# coords_gandia <- osmdata::getbb(\"Gandía, Spain\", format_out = \"matrix\")\n# coords_terrassa <- osmdata::getbb(\"Terrassa, Spain\", format_out = \"matrix\")\n# coords_tarragona <- osmdata::getbb(\"Tarragona, Spain\", format_out = \"matrix\")\n# coords_cordoba <- osmdata::getbb(\"Córdoba, Spain\", format_out = \"matrix\")\n# coords_guadalajara <- osmdata::getbb(\"Guadalajara, Spain\", format_out = \"matrix\")\n# coords_palmas <- osmdata::getbb(\"Las Palmas de Gran Canaria, Spain\", format_out = \"matrix\")\n# coords_santander <- osmdata::getbb(\"Santander, Spain\", format_out = \"matrix\")\n# coords_getafe <- osmdata::getbb(\"Getafe, Spain\", format_out = \"matrix\")\n# coords_munich <- osmdata::getbb(\"Munich, Germany\", format_out = \"matrix\")\n# coords_delegacion <- osmdata::getbb(\"Gustavo A. Madero, Mexico\", format_out = \"matrix\")\n# coords_majadahonda <- osmdata::getbb(\"Majadahonda, Spain\", format_out = \"matrix\")\n# coords_sanfeliu <- osmdata::getbb(\"San Feliú de Llobregat, Spain\", format_out = \"matrix\")\n# coords_burgos <- osmdata::getbb(\"Burgos, Spain\", format_out = \"matrix\")\n# coords_oviedo <- osmdata::getbb(\"Oviedo, Spain\", format_out = \"matrix\")\n# coords_lleida <- osmdata::getbb(\"Lleida, Spain\", format_out = \"matrix\")\n# coords_badalona <- osmdata::getbb(\"Badalona, Spain\", format_out = \"matrix\")\n# coords_santboi <- osmdata::getbb(\"Sant Boi de Llobregat, Spain\", format_out = \"matrix\")\n# coords_laguna <- osmdata::getbb(\"Laguna de Duero, Spain\", format_out = \"matrix\")\n# coords_torrejon <- osmdata::getbb(\"Torrejón de Ardoz\", format_out = \"matrix\")\n\n\n# midpoint <- function(bb) {\n#   c(lon = mean(c(bb[1], bb[3])), lat = mean(c(bb[2], bb[4])))\n# }\n\n\n# barcelona_center <- midpoint(coords_barcelona)\n# madrid_center <- midpoint(coords_madrid)\n# valencia_center <- midpoint(coords_valencia)\n# zaragoza_center <- midpoint(coords_zaragoza)\n# malaga_center <- midpoint(coords_malaga)\n# bilbao_center <- midpoint(coords_bilbao)\n# sevilla_center <- midpoint(coords_sevilla)\n# valladolid_center <- midpoint(coords_valladolid)\n# murcia_center <- midpoint(coords_murcia)\n# alicante_center <- midpoint(coords_alicante)\n# vigo_center <- midpoint(coords_vigo)\n# la_corunya_center <- midpoint(coords_la_corunya)\n# buenos_aires_center <- midpoint(coords_buenos_aires)\n# bogota_center <- midpoint(coords_bogota)\n# santiago_de_chile_center <- midpoint(coords_santiago_de_chile)\n# vitoria_center <- midpoint(coords_vitoria)\n# alcala_center <- midpoint(coords_alcala)\n# granada_center <- midpoint(coords_granada)\n# santiago_de_compostela_center <- midpoint(coords_santiago_de_compostela)\n# sanse_center <- midpoint(coords_sanse)\n# pamplona_center <- midpoint(coords_pamplona)\n# sant_cugat_center <- midpoint(coords_sant_cugat)\n# albacete_center <- midpoint(coords_albacete)\n# lima_center <- midpoint(coords_lima)\n# elche_center <- midpoint(coords_elche)\n# salamanca_center <- midpoint(coords_salamanca)\n# gijon_center <- midpoint(coords_gijon)\n# sabadell_center <- midpoint(coords_sabadell)\n# leon_center <- midpoint(coords_leon)\n# palencia_center <- midpoint(coords_palencia)\n# gandia_center <- midpoint(coords_gandia)\n# terrassa_center <- midpoint(coords_terrassa)\n# tarragona_center <- midpoint(coords_tarragona)\n# cordoba_center <- midpoint(coords_cordoba)\n# guadalajara_center <- midpoint(coords_guadalajara)\n# palmas_center <- midpoint(coords_palmas)\n# santander_center <- midpoint(coords_santander)\n# getafe_center <- midpoint(coords_getafe)\n# munich_center <- midpoint(coords_munich)\n# delegacion_center <- midpoint(coords_delegacion)\n# majadahonda_center <- midpoint(coords_majadahonda)\n# sanfeliu_center <- midpoint(coords_sanfeliu)\n# burgos_center <- midpoint(coords_burgos)\n# oviedo_center <- midpoint(coords_oviedo)\n# lleida_center <- midpoint(coords_lleida)\n# badalona_center <- midpoint(coords_badalona)\n# santboi_center <- midpoint(coords_santboi)\n# laguna_center <- midpoint(coords_laguna)\n# torrejon_center <- midpoint(coords_torrejon)\n# \n# \n# \n# ciudades_coords <- data.frame(\n#   Ciudad = c(\"Barcelona\", \"Madrid\", \"Valencia\", \"Zaragoza\", \"Málaga\", \"Bilbao\", \"Sevilla\", \"Valladolid\", \"Murcia\", \"Alicante\", \"Vigo\", \"La Coruña\", \"Buenos Aires\", \"Bogotá\", \"Santiago de Chile\", \"Vitoria\", \"Alcalá de Henares\", \"Granada\", \"Santiago de Compostela\", \"San Sebastián\", \"Pamplona\", \"Sant Cugat\", \"Albacete\", \"Lima\", \"Elche\", \"Salamanca\", \"Gijón\", \"Sabadell\", \"León\", \"Palencia\", \"Gandía\", \"Terrassa\", \"Tarragona\", \"Córdoba\", \"Guadalajara\", \"Las Palmas de Gran Canaria\", \"Santander\", \"Getafe\", \"Múnich\", \"Delegación Gustavo A. Madero\", \"Majadahonda\", \"San Feliú de Llobregat\", \"Burgos\", \"Oviedo\", \"Lleida\", \"Badalona\", \"Sant Boi de Llobregat\", \"Laguna de Duero\", \"Torrejón de Ardoz\"),\n\n   \n#   Lon = c(barcelona_center[1], madrid_center[1], valencia_center[1],\n# zaragoza_center[1], malaga_center[1], bilbao_center[1], sevilla_center[1], valladolid_center[1], murcia_center[1], alicante_center[1], vigo_center[1], la_corunya_center[1], buenos_aires_center[1], bogota_center[1], santiago_de_chile_center[1], vitoria_center[1], alcala_center[1], granada_center[1], santiago_de_compostela_center[1], sanse_center[1], pamplona_center[1], sant_cugat_center[1], albacete_center[1], lima_center[1], elche_center[1], salamanca_center[1],\n# gijon_center[1], sabadell_center[1], leon_center[1], palencia_center[1],\n# gandia_center[1], terrassa_center[1], tarragona_center[1], cordoba_center[1], guadalajara_center[1], palmas_center[1], santander_center[1], getafe_center[1], munich_center[1], delegacion_center[1], majadahonda_center[1], sanfeliu_center[1], burgos_center[1], oviedo_center[1], lleida_center[1], badalona_center[1], santboi_center[1], laguna_center[1], torrejon_center[1]),\n\n\n# Lat = c(barcelona_center[2], madrid_center[2], valencia_center[2],\n# zaragoza_center[2], malaga_center[2], bilbao_center[2], sevilla_center[2], valladolid_center[2], murcia_center[2], alicante_center[2], vigo_center[2], la_corunya_center[2], buenos_aires_center[2], bogota_center[2], santiago_de_chile_center[2], vitoria_center[2], alcala_center[2], granada_center[2], santiago_de_compostela_center[2], sanse_center[2], pamplona_center[2], sant_cugat_center[2], albacete_center[2], lima_center[2], elche_center[2], salamanca_center[2],\n# gijon_center[2], sabadell_center[2], leon_center[2], palencia_center[2],\n# gandia_center[2], terrassa_center[2], tarragona_center[2], cordoba_center[2], guadalajara_center[2], palmas_center[2], santander_center[2], getafe_center[2], munich_center[2], delegacion_center[2], majadahonda_center[2], sanfeliu_center[2], burgos_center[2], oviedo_center[2], lleida_center[2], badalona_center[2], santboi_center[2], laguna_center[2], torrejon_center[2]))\n\n\n# #library(openxlsx)\n# ruta_archivo <- \"Datos/ciudades_coords.xlsx\"\n# write.xlsx(ciudades_coords, file = ruta_archivo)\n\n## Para evitar que la página deba cargar todo lo anterior he generado un excel sobre el df con las coordenadas\n\nDemografia <-  read_excel(\"Datos/Demografia.xlsx\")\nciudades_coords <- read_excel(\"Datos/ciudades_coords.xlsx\")\n\ndf_coord <- left_join(Demografia, ciudades_coords, by = \"Ciudad\")\n\n```\n\nEn este mapamundi, podemos observar las ciudades/municipios con el mayor número de oyentes del grupo durante el mes de diciembre. En color rojo están las ciudades que han tenido más de 100 oyentes, en color azul las que han tenido entre 10 y 100 oyentes, y en color verde las ciudades que han tenido menos de 10 oyentes. Las ciudades con más oyentes en diciembre fueron Barcelona con 345 oyentes y Madrid con 311.\n\n::: panel-tabset\n\n## Mapa con numero de oyentes en Diciembre\n\n```{r}\n#| code-fold: true\n#| warning: false\n\nmap <- leaflet(df_coord) %>% \n  addTiles() %>%  # Añadir las tiles básicas del mapa\n  \n# Para añadir marcadores circulares según el grupo\n  \n  addCircleMarkers(\n    ~Lon, ~Lat,  # Coordenadas\n    color = ~case_when(\n      Grupo == \"Ultra fans\" ~ \"red\", #Más de 100 oyentes\n      Grupo == \"Muy fans\" ~ \"blue\", #10 oyentes o más hasta 100\n      Grupo == \"Fans\" ~ \"green\", #Menos de 10 oyentes\n      TRUE ~ \"gray\"  # Por defecto para otros grupos\n    ),\n    popup = ~paste(Ciudad, Oyentes),  # Texto emergente\n    radius = 8  # Tamaño del marcador\n  )\n\nmap\n\n```\n\n## Procedimiento\n\nPara realizar este Leaflet, en primer lugar, he tenido que obtener las latitudes y longitudes de cada ciudad mediante el paquete osmdata. Sin embargo, también he tenido que encontrar los puntos medios de esas medidas y añadirlos al dataframe con los datos. Una vez obtenido el dataframe necesario, he generado el Leaflet añadiendo círculos de colores según el grupo al que pertenecía cada ciudad, con el tamaño deseado y una etiqueta con el número de oyentes en cada ciudad.\n\n:::\n\n# Demografría\n\n```{r}\n#| code-fold: true\n#| warning: false\n\n# Aprovechando que son pocos datos y no los tengo, he creado el df a mano para prácticar\n\nEdad_b <- data.frame(\n  row.names = c(\"a18_22\", \"a23_27\", \"a28_34\", \"a35_44\", \"a45_59\", \"aMas_60\"),\n  Mujer = c(78, 172, 153, 89, 84, 18),\n  Hombre = c(53, 136, 172, 142, 168, 21),\n  Sin_especificar = c(2, 1, 7, 5, 4, 2),\n  No_binario = c(8, 16, 8, 9, 2, 0))\n\n# Marcarmos los valores maximos y minimos para poder elaborar el gráfico de araña\n\nmax_min <- data.frame(\n  Mujer = c(172, 0), Hombre = c(172, 0), Sin_especificar = c(7, 0), No_binario = c(16, 0)\n)\n\n# Para añadir las filas al df final\n\nrownames(max_min) <- c(\"Max\", \"Min\")\nedad_bien <- rbind(max_min, Edad_b)\n\n# Seleccionamos únicamente los datos de 18 a 22 años y así sucesivamente.\n\na18_22_data <- edad_bien[c(\"Max\", \"Min\", \"a18_22\"), ]\n\na23_27_data <- edad_bien[c(\"Max\", \"Min\", \"a23_27\"), ]\n\na28_34_data <- edad_bien[c(\"Max\", \"Min\", \"a28_34\"), ]\n\na35_44_data <- edad_bien[c(\"Max\", \"Min\", \"a35_44\"), ]\n\na45_59_data <- edad_bien[c(\"Max\", \"Min\", \"a45_59\"), ]\n\naMas_60_data <- edad_bien[c(\"Max\", \"Min\", \"aMas_60\"), ]\n\n\n```\n\nSe han tomado los datos del número de oyentes en el mes de diciembre según su género y la franja de edad a la que pertenecen.\n\nMediante estos gráficos radiales con forma de tela de araña podemos observar cuanto se acerca o aleja dicho género en esa franja de edad frente al máximo registrado de ese genero en cualquier grupo de edad.\n\nPongo varios ejemplos para que se entienda. En el grupo de 18 a 22 años de edad observamos que los puntos negros no se alejan mucho del centro, esto se debe a que es un grupo poco numeroso relativamente al resto de grupos de edad, por ejemplo, en este grupo se han observado 53 hombres (muy lejos del máximo de 172 hombres registrados de los 28 a 34 años). Otro ejemplo podría ser en el grupo de 23 a 27 años, donde encontramos los máximos registrados de mujeres (172) y de no binario (16), por lo tanto viendo el gráfico tambien podemos intuir que este grupo de edad es de los más numerosos, ya que sus 4 valores se alejan bastante del centro.\n\n::: panel-tabset\n\n## 18 a 22\n\n```{r}\n#| code-fold: true\n#| warning: false \np18_22 <- radarchart(\n  a18_22_data,\n  title = \"De 18 a 22 años\",\n  cglcol = \"orange\", #Color de los bordes del gráfico\n  cglty = 2, #Permite obtener patrones separados\n  cglwd = 2, #Permite ajustar la separacion\n  plwd = 2, #Permite añadir el grosor\n  pfcol = \"#EED9AD80\"  # Color del fondo interno del polígono\n)\nradarchart(p18_22)\n```\n\n## 23 a 27\n\n```{r}\n#| code-fold: true\n#| warning: false\n\np23_27 <- radarchart(\n  a23_27_data,\n  title = \"De 23 a 27 años\",\n  cglcol = \"green\",\n  cglty = 2,\n  cglwd = 2,\n  plwd = 2,\n  pfcol = \"#D7EEAD80\"  \n)\nradarchart(p23_27)\n\n```\n\n## 28 a 34\n\n```{r}\n#| code-fold: true\n#| warning: false\n\np28_34 <- radarchart(\n  a28_34_data,\n  title = \"De 28 a 34 años\",\n  cglcol = \"pink\",\n  cglty = 2,\n  cglwd = 2,\n  plwd = 2,\n  pfcol = \"#EED3F180\" \n)\nradarchart(p28_34)\n\n```\n\n## 35 a 44\n\n```{r}\n#| code-fold: true\n#| warning: false\n\np35_44 <- radarchart(\n  a35_44_data,\n  title = \"De 35 a 44 años\",\n  cglcol = \"blue\",\n  cglty = 2,\n  cglwd = 2,\n  plwd = 2,\n  pfcol = \"#D3E3F180\"\n)\nradarchart(p35_44)\n\n```\n\n## 45 a 59\n\n```{r}\n#| code-fold: true\n#| warning: false\n\np45_59 <- radarchart(\n  a45_59_data,\n  title = \"De 45 a 59 años\",\n  cglcol = \"red\",\n  cglty = 2,\n  cglwd = 2,\n  plwd = 2,\n  pfcol = \"#EDBDBD80\" \n)\nradarchart(p45_59)\n\n```\n\n## Más de 60\n\n```{r}\n#| code-fold: true\n#| warning: false\n\npMas_60 <- radarchart(\n  aMas_60_data,\n  title = \"Más de 60 años\",\n  cglcol = \"purple\",\n  cglty = 2,\n  cglwd = 2,\n  plwd = 2,\n  pfcol = \"#D7BDED80\"  \n)\nradarchart(pMas_60)\n\n```\n\n:::\n\n## Procedimiento\n\nPara elaborar estos gráficos radiales (o spiderweb) con forma de diamante, he creado los dataframes mediante R, ya que eran pocos datos y no era muy costoso hacerlo a mano. Además, generé otro dataframe con los valores máximos registrados, estableciendo 0 como el valor mínimo. Una vez creados, los uní para obtener el dataframe con todos los datos necesarios.\n\nPosteriormente, filtré los dataframes por rango de edad y valores máximos y mínimos para crear los radarcharts. Me hubiera gustado colocarlos en formaciones de dos mediante la función \"#| layout-nrow: 2\", pero debido a algún problema con el paquete, probablemente se veían mal al reducir su tamaño. A pesar de mi preferencia, opté por utilizar panel-tabset.\n\n\n<br>\n\n----------------------\n\n<br>\n\n\n## Información sobre la sesión\n\nEntorno de trabajo y paquetes utilizados\n\n```{r}\n#| echo: false\nsessioninfo::session_info() %>% \n  details::details(summary = 'current session info') \n```\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"message":false,"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"show","code-overflow":"wrap","code-link":true,"code-line-numbers":true,"code-tools":true,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":true,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","highlight-style":"a10y","css":["my_styles.css"],"toc":true,"toc-depth":3,"embed-resources":true,"output-file":"my_trabajo_BigData.html"},"language":{"toc-title-document":"Tabla de contenidos","toc-title-website":"En esta página","related-formats-title":"Otros formatos","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Fuente","section-title-abstract":"Resumen","section-title-appendices":"Apéndices","section-title-footnotes":"Notas","section-title-references":"Referencias","section-title-reuse":"Reutilización","section-title-copyright":"Derechos de autor","section-title-citation":"Cómo citar","appendix-attribution-cite-as":"Por favor, cita este trabajo como:","appendix-attribution-bibtex":"BibTeX","title-block-author-single":"Autor/a","title-block-author-plural":"Autores/as","title-block-affiliation-single":"Afiliación","title-block-affiliation-plural":"Afiliaciones","title-block-published":"Fecha de publicación","title-block-modified":"Fecha de modificación","callout-tip-title":"Tip","callout-note-title":"Nota","callout-warning-title":"Advertencia","callout-important-title":"Importante","callout-caution-title":"Precaución","code-summary":"Código","code-tools-menu-caption":"Código","code-tools-show-all-code":"Mostrar todo el código","code-tools-hide-all-code":"Ocultar todo el código","code-tools-view-source":"Ver el código fuente","code-tools-source-code":"Ejecutar el código","code-line":"Línea","code-lines":"Líneas","copy-button-tooltip":"Copiar al portapapeles","copy-button-tooltip-success":"Copiado","repo-action-links-edit":"Editar esta página","repo-action-links-source":"Ver el código","repo-action-links-issue":"Informar de un problema","back-to-top":"Volver arriba","search-no-results-text":"Sin resultados","search-matching-documents-text":"documentos encontrados","search-copy-link-title":"Copiar el enlace en la búsqueda","search-hide-matches-text":"Ocultar resultados adicionales","search-more-match-text":"resultado adicional en este documento","search-more-matches-text":"resultados adicionales en este documento","search-clear-button-title":"Borrar","search-detached-cancel-button-title":"Cancelar","search-submit-button-title":"Enviar","search-label":"Buscar","toggle-section":"Alternar sección","toggle-sidebar":"Alternar barra lateral","toggle-dark-mode":"Alternar modo oscuro","toggle-reader-mode":"Alternar modo lector","toggle-navigation":"Navegación de palanca","crossref-fig-title":"Figura","crossref-tbl-title":"Tabla","crossref-lst-title":"Listado","crossref-thm-title":"Teorema","crossref-lem-title":"Lema","crossref-cor-title":"Corolario","crossref-prp-title":"Proposición","crossref-cnj-title":"Conjetura","crossref-def-title":"Definición","crossref-exm-title":"Ejemplo","crossref-exr-title":"Ejercicio","crossref-ch-prefix":"Capítulo","crossref-apx-prefix":"Apéndice","crossref-sec-prefix":"Sección","crossref-eq-prefix":"Ecuación","crossref-lof-title":"Listado de Figuras","crossref-lot-title":"Listado de Tablas","crossref-lol-title":"Listado de Listados","environment-proof-title":"Prueba","environment-remark-title":"Observación","environment-solution-title":"Solución","listing-page-order-by":"Ordenar por","listing-page-order-by-default":"Por defecto","listing-page-order-by-date-asc":"Menos reciente","listing-page-order-by-date-desc":"Más reciente","listing-page-order-by-number-desc":"De mayor a menor","listing-page-order-by-number-asc":"De menor a mayor","listing-page-field-date":"Fecha","listing-page-field-title":"Título","listing-page-field-description":"Descripción","listing-page-field-author":"Autor/a","listing-page-field-filename":"Nombre de archivo","listing-page-field-filemodified":"Fecha de modificación","listing-page-field-subtitle":"Subtítulo","listing-page-field-readingtime":"Tiempo de lectura","listing-page-field-categories":"Categorías","listing-page-minutes-compact":"{0} minutos","listing-page-category-all":"Todas","listing-page-no-matches":"No hay resultados"},"metadata":{"lang":"es","fig-responsive":true,"quarto-version":"1.3.450","theme":"flatly","mainfont":"Baskerville","page-layout":"full","toc_float":true,"toc_collapsed":true,"toc-location":"right","toc-title":"Índice","code-copy":true,"title":"Paco Te quiero","description":"(El grupo de música barcelonés)","author":["Javier Mascarell (jamasga@alumni.uv.es)"],"date":"2024-01-19","categories":["trabajo BigData"],"image":"imagenes/r_logo.png","title-block-banner":true,"title-block-banner-color":"#FBFCF5","smooth-scroll":true,"backgroundcolor":"#FBFCF5"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}